#theme-dialog {
    background: white;
    border: 1px solid #ccc;
}

body.dark-mode #theme-dialog {
    background: #1e1e1e;
    border-color: #444;
    color: #e0e0e0;
}

body.dark-mode #theme-dialog input[type="radio"],
body.dark-mode #theme-dialog input[type="checkbox"] {
    accent-color: #0078d4;
}

body.dark-mode #theme-dialog label {
    color: #e0e0e0;
}

body.dark-mode #theme-dialog button {
    background: #23272a;
    color: #e0e0e0;
    border-color: #444;
}

body.dark-mode #theme-dialog #theme-dialog-apply {
    background: #0078d4;
    border-color: #0078d4;
}

body.dark-mode #theme-dialog button:hover {
    background: #2d3136;
}

/* Hide old theme dialog components */
.theme-dialog-body,
.theme-dialog-grid,
.theme-options-column,
.theme-preview-column,
.theme-dialog-heading,
.settings-toggle,
.settings-toggle input[type="checkbox"],
.settings-toggle .toggle-track,
.settings-toggle .toggle-track .toggle-thumb,
.settings-toggle:hover .toggle-track,
.settings-toggle input[type="checkbox"]:focus-visible + .toggle-track,
.settings-toggle input[type="checkbox"]:checked + .toggle-track,
.settings-toggle input[type="checkbox"]:checked + .toggle-track .toggle-thumb,
.settings-toggle input[type="checkbox"][disabled] + .toggle-track,
.settings-toggle input[type="checkbox"][disabled] + .toggle-track .toggle-thumb,
body.dark-mode .settings-toggle .toggle-track,
body.dark-mode .settings-toggle input[type="checkbox"]:checked + .toggle-track,
body.dark-mode .settings-toggle .toggle-track .toggle-thumb,
body.dark-mode .settings-toggle input[type="checkbox"]:checked + .toggle-track .toggle-thumb,
.theme-option-grid,
.theme-swatch,
.theme-swatch input,
.theme-swatch:hover,
.theme-squircle,
.theme-squircle::before,
.theme-squircle::after,
.theme-squircle-auto::before,
.theme-squircle-auto::after,
.theme-squircle-light::before,
.theme-squircle-light::after,
.theme-squircle-dark::before,
.theme-squircle-dark::after,
.theme-squircle-check,
.theme-swatch input:checked + .theme-squircle,
.theme-swatch input:checked + .theme-squircle .theme-squircle-check,
.theme-swatch input:focus-visible + .theme-squircle,
.theme-swatch-name,
.theme-swatch-desc,
.theme-compact-checkbox,
.theme-compact-checkbox:hover,
.theme-compact-checkbox input[type="checkbox"],
.theme-compact-checkbox input[type="checkbox"]:focus-visible,
.theme-compact-copy,
.theme-compact-title,
.theme-compact-desc,
.theme-preview-area,
.theme-preview-header,
.theme-preview-title,
.theme-preview-subtitle,
.theme-preview-hint,
.theme-preview-shell,
.theme-preview-shell.theme-preview-dark,
.theme-preview-toolbar,
.theme-preview-shell.theme-preview-dark .theme-preview-toolbar,
.theme-preview-window-controls,
.theme-preview-dot,
.theme-preview-dot.red,
.theme-preview-dot.amber,
.theme-preview-dot.green,
.theme-preview-shell.theme-preview-dark .theme-preview-dot.red,
.theme-preview-shell.theme-preview-dark .theme-preview-dot.amber,
.theme-preview-shell.theme-preview-dark .theme-preview-dot.green,
.theme-preview-tabs,
.theme-preview-tab,
.theme-preview-tab.active,
.theme-preview-shell.theme-preview-dark .theme-preview-tabs,
.theme-preview-shell.theme-preview-dark .theme-preview-tab,
.theme-preview-shell.theme-preview-dark .theme-preview-tab.active,
.theme-preview-icon,
.theme-preview-shell.theme-preview-dark .theme-preview-icon,
.theme-preview-body,
.theme-preview-pane,
.theme-preview-shell.theme-preview-compact .theme-preview-pane,
.theme-preview-line,
.theme-preview-line.heading,
.theme-preview-line.medium,
.theme-preview-line.long,
.theme-preview-line.short,
.theme-preview-shell.theme-preview-dark .theme-preview-line,
.theme-preview-shell.theme-preview-dark .theme-preview-line.heading,
.theme-preview-card,
.theme-preview-card-heading,
.theme-preview-card-line,
.theme-preview-card-line.narrow,
.theme-preview-card-chip-row,
.theme-preview-chip,
.theme-preview-shell.theme-preview-dark .theme-preview-card,
.theme-preview-shell.theme-preview-dark .theme-preview-card-heading,
.theme-preview-shell.theme-preview-dark .theme-preview-card-line,
.theme-preview-shell.theme-preview-dark .theme-preview-chip,
.theme-preview-shell.theme-preview-compact .theme-preview-card,
.theme-preview-shell.theme-preview-compact .theme-preview-card-chip-row,
.theme-preview-shell.theme-preview-compact .theme-preview-chip {
    display: none !important;
}

.settings-toggle {
    position: relative;
    display: inline-flex;
    align-items: center;
    gap: 12px;
    cursor: pointer;
    user-select: none;
}

.settings-toggle input[type="checkbox"] {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0 0 0 0);
    white-space: nowrap;
    border: 0;
}

.settings-toggle .toggle-track {
    display: inline-flex;
    align-items: center;
    justify-content: flex-start;
    width: 44px;
    height: 24px;
    border-radius: 999px;
    background: rgba(148, 163, 184, 0.35);
    box-shadow: inset 0 0 0 1px rgba(148, 163, 184, 0.22);
    position: relative;
    transition: background 0.2s ease, box-shadow 0.2s ease;
}

.settings-toggle .toggle-track .toggle-thumb {
    position: absolute;
    top: 2px;
    left: 2px;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background: #fff;
    box-shadow: 0 4px 10px rgba(15, 23, 42, 0.16);
    transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
}

.settings-toggle:hover .toggle-track {
    box-shadow: inset 0 0 0 1px rgba(37, 99, 235, 0.2);
}

.settings-toggle input[type="checkbox"]:focus-visible + .toggle-track {
    box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.22), inset 0 1px 0 rgba(255, 255, 255, 0.35);
}

.settings-toggle input[type="checkbox"]:checked + .toggle-track {
    background: linear-gradient(135deg, #2563eb 0%, #0ea5e9 100%);
    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.35);
}

.settings-toggle input[type="checkbox"]:checked + .toggle-track .toggle-thumb {
    transform: translateX(20px);
    box-shadow: 0 6px 12px rgba(37, 99, 235, 0.25);
}

.settings-toggle input[type="checkbox"][disabled] + .toggle-track {
    opacity: 0.55;
    cursor: not-allowed;
}

.settings-toggle input[type="checkbox"][disabled] + .toggle-track .toggle-thumb {
    background: rgba(255, 255, 255, 0.85);
    box-shadow: 0 2px 6px rgba(148, 163, 184, 0.3);
}

body.dark-mode .settings-toggle .toggle-track {
    background: rgba(71, 85, 105, 0.5);
    box-shadow: inset 0 0 0 1px rgba(203, 213, 225, 0.35);
}

body.dark-mode .settings-toggle input[type="checkbox"]:checked + .toggle-track {
    background: linear-gradient(135deg, rgba(59, 130, 246, 0.85) 0%, rgba(14, 165, 233, 0.8) 100%);
    box-shadow: inset 0 0 0 1px rgba(148, 197, 255, 0.45), inset 0 1px 0 rgba(255, 255, 255, 0.24);
}

body.dark-mode .settings-toggle .toggle-track .toggle-thumb {
    background: #ffffff;
    box-shadow: 0 2px 6px rgba(2, 6, 23, 0.55);
}

body.dark-mode .settings-toggle input[type="checkbox"]:checked + .toggle-track .toggle-thumb {
    background: #ffffff;
    box-shadow: 0 6px 12px rgba(14, 165, 233, 0.28);
}

.theme-option-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
    gap: 18px;
}

.theme-swatch {
    position: relative;
    display: flex;
    flex-direction: column;
    gap: 12px;
    padding: 16px;
    border-radius: 16px;
    border: 1px solid rgba(148, 163, 184, 0.28);
    background: rgba(255, 255, 255, 0.88);
    cursor: pointer;
    transition: border-color 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
    user-select: none;
}

.theme-swatch input {
    display: none;
}

.theme-swatch:hover {
    border-color: rgba(37, 99, 235, 0.45);
    box-shadow: 0 8px 16px rgba(15, 23, 42, 0.08);
}

.theme-squircle {
    width: 74px;
    height: 74px;
    border-radius: 26px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    position: relative;
    overflow: hidden;
    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.6);
    border: 1px solid rgba(148, 163, 184, 0.35);
    transition: transform 0.25s ease, box-shadow 0.25s ease, border-color 0.25s ease;
}

.theme-squircle::before,
.theme-squircle::after {
    content: '';
    position: absolute;
    inset: 0;
    opacity: 0.65;
}

.theme-squircle-auto::before {
    background: linear-gradient(140deg, #f8fafc 0%, #dde3f7 45%, #1f2937 46%, #0f172a 100%);
}

.theme-squircle-auto::after {
    background: radial-gradient(circle at 30% 28%, rgba(255, 255, 255, 0.55), transparent 58%),
                radial-gradient(circle at 70% 72%, rgba(255, 255, 255, 0.35), transparent 60%);
    mix-blend-mode: screen;
}

.theme-squircle-light::before {
    background: linear-gradient(140deg, #ffffff 0%, #f8fafc 55%, #e2e8f0 100%);
}

.theme-squircle-light::after {
    background: radial-gradient(circle at 28% 26%, rgba(255, 255, 255, 0.9), transparent 60%),
                radial-gradient(circle at 70% 80%, rgba(226, 232, 240, 0.8), transparent 70%);
    mix-blend-mode: screen;
}

.theme-squircle-dark::before {
    background: linear-gradient(140deg, #1f2933 0%, #101926 45%, #050a12 100%);
}

.theme-squircle-dark::after {
    background: radial-gradient(circle at 28% 26%, rgba(59, 130, 246, 0.35), transparent 60%),
                radial-gradient(circle at 70% 80%, rgba(14, 165, 233, 0.25), transparent 70%);
    mix-blend-mode: screen;
}

.theme-squircle-check {
    position: relative;
    z-index: 2;
    font-size: 28px;
    color: #fff;
    opacity: 0;
    transform: scale(0.5);
    transition: opacity 0.18s ease, transform 0.18s ease;
}

.theme-swatch input:checked + .theme-squircle {
    border-color: rgba(37, 99, 235, 0.55);
    box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.18), 0 12px 22px rgba(15, 23, 42, 0.16);
    transform: translateY(-2px);
}

.theme-swatch input:checked + .theme-squircle .theme-squircle-check {
    opacity: 1;
    transform: scale(1);
}

.theme-swatch input:focus-visible + .theme-squircle {
    outline: 2px solid rgba(37, 99, 235, 0.6);
    outline-offset: 3px;
}

.theme-swatch-name {
    font-weight: 600;
    font-size: 14px;
    color: #0f172a;
}

.theme-swatch-desc {
    font-size: 12px;
    color: #475569;
}

.theme-compact-checkbox {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    padding: 12px 18px;
    border-radius: 12px;
    border: 1px solid rgba(148, 163, 184, 0.2);
    background: rgba(248, 250, 252, 0.8);
    cursor: pointer;
    transition: border-color 0.2s ease, background 0.2s ease, box-shadow 0.2s ease;
}

.theme-compact-checkbox:hover {
    border-color: rgba(37, 99, 235, 0.4);
    box-shadow: 0 8px 16px rgba(15, 23, 42, 0.08);
}

.theme-compact-checkbox input[type="checkbox"] {
    width: 18px;
    height: 18px;
    margin-top: 1px;
    flex-shrink: 0;
    accent-color: #2563eb;
}

.theme-compact-checkbox input[type="checkbox"]:focus-visible {
    outline: 2px solid rgba(37, 99, 235, 0.45);
    outline-offset: 2px;
}

.theme-compact-copy {
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.theme-compact-title {
    font-size: 14px;
    font-weight: 600;
    color: #0f172a;
}

.theme-compact-desc {
    font-size: 12px;
    color: #475569;
}


.theme-preview-area {
    flex: 1 1 100%;
    border-radius: 20px;
    border: 1px solid rgba(148, 163, 184, 0.22);
    background: rgba(255, 255, 255, 0.9);
    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.6);
    padding: 22px 24px;
    display: flex;
    flex-direction: column;
    gap: 18px;
    min-height: 0;
    overflow: auto;
}

.theme-preview-header {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    gap: 12px;
}

.theme-preview-title {
    font-size: 16px;
    font-weight: 700;
    color: #0f172a;
}

.theme-preview-subtitle {
    font-size: 13px;
    color: #475569;
    margin-top: 4px;
}

.theme-preview-hint {
    font-size: 12px;
    color: #475569;
    text-align: right;
}

.theme-preview-shell {
    border-radius: 18px;
    border: 1px solid rgba(148, 163, 184, 0.32);
    background: linear-gradient(160deg, rgba(249, 250, 255, 0.95) 0%, rgba(228, 234, 247, 0.96) 100%);
    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.8);
    overflow: hidden;
    transition: background 0.25s ease, border-color 0.25s ease, box-shadow 0.25s ease;
    display: flex;
    flex-direction: column;
    flex: 1 1 auto;
    min-height: 0;
}

.theme-preview-shell.theme-preview-dark {
    background: linear-gradient(160deg, rgba(30, 41, 59, 0.94) 0%, rgba(17, 24, 39, 0.96) 100%);
    border-color: rgba(59, 73, 97, 0.6);
    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.07);
}

.theme-preview-toolbar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 16px;
    padding: 14px 18px;
    background: rgba(249, 250, 255, 0.92);
    border-bottom: 1px solid rgba(148, 163, 184, 0.28);
    flex-shrink: 0;
}

.theme-preview-shell.theme-preview-dark .theme-preview-toolbar {
    background: rgba(30, 41, 59, 0.92);
    border-bottom-color: rgba(59, 73, 97, 0.55);
}

.theme-preview-window-controls {
    display: inline-flex;
    align-items: center;
    gap: 6px;
}

.theme-preview-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    display: inline-block;
}

.theme-preview-dot.red { background: #ff5f57; }
.theme-preview-dot.amber { background: #febb2e; }
.theme-preview-dot.green { background: #28c840; }

.theme-preview-shell.theme-preview-dark .theme-preview-dot.red { background: #ff6b6b; }
.theme-preview-shell.theme-preview-dark .theme-preview-dot.amber { background: #ffd166; }
.theme-preview-shell.theme-preview-dark .theme-preview-dot.green { background: #70e000; }

.theme-preview-tabs {
    display: inline-flex;
    gap: 8px;
    font-size: 12px;
    font-weight: 600;
    color: #475569;
}

.theme-preview-tab {
    padding: 6px 10px;
    border-radius: 8px;
    background: rgba(148, 163, 184, 0.18);
}

.theme-preview-tab.active {
    background: rgba(37, 99, 235, 0.15);
    color: #1d4ed8;
}

.theme-preview-shell.theme-preview-dark .theme-preview-tabs {
    color: #cbd5f5;
}

.theme-preview-shell.theme-preview-dark .theme-preview-tab {
    background: rgba(96, 165, 250, 0.18);
    color: #a5b4fc;
}

.theme-preview-shell.theme-preview-dark .theme-preview-tab.active {
    background: rgba(59, 130, 246, 0.25);
    color: #e0e7ff;
}

.theme-preview-icon {
    font-size: 22px;
    color: #2563eb;
}

.theme-preview-shell.theme-preview-dark .theme-preview-icon {
    color: #93c5fd;
}

.theme-preview-body {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 0;
    flex: 1 1 auto;
    min-height: 0;
}

.theme-preview-pane {
    padding: 18px 22px 24px;
    display: flex;
    flex-direction: column;
    gap: 10px;
    overflow: auto;
    min-height: 0;
}

.theme-preview-shell.theme-preview-compact .theme-preview-pane {
    padding: 12px 16px 16px;
    gap: 6px;
}

.theme-preview-line {
    height: 10px;
    border-radius: 6px;
    background: rgba(148, 163, 184, 0.4);
    transition: transform 0.2s ease, opacity 0.2s ease;
}

.theme-preview-line.heading {
    height: 14px;
    width: 70%;
    background: rgba(59, 130, 246, 0.3);
}

.theme-preview-line.medium { width: 85%; }
.theme-preview-line.long { width: 95%; }
.theme-preview-line.short { width: 55%; }

.theme-preview-shell.theme-preview-dark .theme-preview-line {
    background: rgba(148, 163, 184, 0.32);
}

.theme-preview-shell.theme-preview-dark .theme-preview-line.heading {
    background: rgba(96, 165, 250, 0.38);
}

.theme-preview-card {
    border-radius: 16px;
    border: 1px solid rgba(148, 163, 184, 0.32);
    background: rgba(255, 255, 255, 0.85);
    padding: 18px 20px;
    display: grid;
    gap: 12px;
    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.7);
}

.theme-preview-card-heading {
    width: 60%;
    height: 12px;
    border-radius: 6px;
    background: rgba(148, 163, 184, 0.45);
}

.theme-preview-card-line {
    height: 10px;
    border-radius: 6px;
    background: rgba(148, 163, 184, 0.35);
}

.theme-preview-card-line.narrow {
    width: 60%;
}

.theme-preview-card-chip-row {
    display: inline-flex;
    gap: 8px;
}

.theme-preview-chip {
    width: 22px;
    height: 8px;
    border-radius: 999px;
    background: rgba(37, 99, 235, 0.38);
}

.theme-preview-shell.theme-preview-dark .theme-preview-card {
    background: rgba(15, 23, 42, 0.9);
    border-color: rgba(59, 73, 97, 0.5);
    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.04);
}

.theme-preview-shell.theme-preview-dark .theme-preview-card-heading {
    background: rgba(96, 165, 250, 0.42);
}

.theme-preview-shell.theme-preview-dark .theme-preview-card-line {
    background: rgba(148, 163, 184, 0.32);
}

.theme-preview-shell.theme-preview-dark .theme-preview-chip {
    background: rgba(96, 165, 250, 0.45);
}

.theme-preview-shell.theme-preview-compact .theme-preview-card {
    padding: 14px 18px;
    gap: 10px;
}

.theme-preview-shell.theme-preview-compact .theme-preview-card-chip-row {
    gap: 6px;
}

.theme-preview-shell.theme-preview-compact .theme-preview-chip {
    width: 20px;
}

.theme-dialog-actions {
    display: flex;
    justify-content: flex-end;
    gap: 12px;
    flex-shrink: 0;
    padding: 16px 32px;
    border-top: 1px solid rgba(148, 163, 184, 0.2);
    background: rgba(248, 250, 252, 0.5);
}

.theme-dialog-btn {
    padding: 10px 22px;
    border-radius: 12px;
    font-size: 13px;
    font-weight: 600;
    border: none;
    cursor: pointer;
    transition: transform 0.18s ease, box-shadow 0.2s ease, background 0.2s ease;
}

.theme-dialog-btn.secondary {
    background: rgba(226, 232, 240, 0.7);
    color: #475569;
}

.theme-dialog-btn.secondary:hover {
    background: rgba(203, 213, 225, 0.95);
    transform: translateY(-1px);
}

.theme-dialog-btn.primary {
    background: linear-gradient(135deg, #2563eb 0%, #0ea5e9 100%);
    color: #fff;
    box-shadow: 0 12px 22px rgba(37, 99, 235, 0.25);
}

.theme-dialog-btn.primary:hover {
    transform: translateY(-1px);
    box-shadow: 0 16px 28px rgba(37, 99, 235, 0.3);
}

.theme-dialog-btn:active {
    transform: translateY(0);
    box-shadow: none;
}

body.dark-mode #theme-dialog {
    background: rgba(15, 23, 42, 0.96) !important;
    border-color: rgba(59, 73, 97, 0.6) !important;
}

body.dark-mode .theme-dialog-body {
    background: rgba(15, 23, 42, 0.94);
    color: #e2e8f0;
}

body.dark-mode .theme-dialog-heading {
    color: #e0f2fe;
}

body.dark-mode .theme-swatch {
    background: rgba(15, 23, 42, 0.85);
    border-color: rgba(59, 73, 97, 0.55);
}

body.dark-mode .theme-swatch:hover {
    border-color: rgba(96, 165, 250, 0.55);
    box-shadow: 0 12px 18px rgba(2, 6, 23, 0.45);
}

body.dark-mode .theme-swatch-name {
    color: #e2e8f0;
}

body.dark-mode .theme-swatch-desc {
    color: #94a3b8;
}

body.dark-mode .theme-swatch input:checked ~ .theme-swatch-name {
    color: #93c5fd;
}

body.dark-mode .theme-dialog-section {
    background: rgba(15, 23, 42, 0.88);
    border-color: rgba(59, 73, 97, 0.5);
}

body.dark-mode .theme-section-title {
    color: #cbd5f5;
}

body.dark-mode .theme-compact-checkbox {
    background: rgba(30, 41, 59, 0.82);
    border-color: rgba(59, 73, 97, 0.55);
}

body.dark-mode .theme-compact-title {
    color: #e2e8f0;
}

body.dark-mode .theme-compact-desc {
    color: #94a3b8;
}

body.dark-mode .theme-compact-checkbox input[type="checkbox"] {
    accent-color: #4fc3f7;
}

body.dark-mode .theme-preview-area {
    background: rgba(15, 23, 42, 0.92);
    border-color: rgba(59, 73, 97, 0.6);
    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.04);
}

body.dark-mode .theme-preview-title {
    color: #e2e8f0;
}

body.dark-mode .theme-preview-subtitle,
body.dark-mode .theme-preview-hint {
    color: #94a3b8;
}

body.dark-mode .theme-dialog-btn.secondary {
    background: rgba(30, 41, 59, 0.88);
    color: #e2e8f0;
}

body.dark-mode .theme-dialog-btn.secondary:hover {
    background: rgba(51, 65, 85, 0.95);
}

@media (max-width: 1200px) {
    #theme-dialog {
        width: min(1000px, 92vw) !important;
    }
}

@media (max-width: 980px) {
    #theme-dialog {
        width: min(95vw, 900px) !important;
        max-height: 95vh;
    }

    .theme-dialog-grid {
        flex-direction: column;
        gap: 24px;
    }

    .theme-options-column {
        flex: 0 0 auto;
    }

    .theme-preview-column {
        flex: 1 1 auto;
        min-height: 400px;
    }
}

@media (max-width: 768px) {
    #theme-dialog {
        width: 98vw !important;
        max-height: 98vh;
    }

    .theme-dialog-body {
        padding: 20px 20px 20px;
        gap: 20px;
    }

    .theme-dialog-grid {
        gap: 16px;
    }
}

@media (max-width: 540px) {
    #theme-dialog {
        width: 99vw !important;
        max-height: 99vh;
    }

    .theme-dialog-body {
        padding: 16px 16px 16px;
        gap: 16px;
    }

    .theme-dialog-grid {
        flex-direction: column;
        gap: 16px;
    }

    .theme-options-column {
        flex: 0 0 auto;
        max-height: none;
    }

    .theme-preview-column {
        flex: 0 0 auto;
        min-height: 350px;
    }

    .theme-preview-body {
        grid-template-columns: 1fr;
    }

    .theme-preview-header {
        flex-direction: column;
        align-items: flex-start;
    }

    .theme-preview-hint {
        text-align: left;
    }

    .theme-dialog-actions {
        padding: 12px 16px;
    }

    .theme-dialog-btn {
        padding: 8px 16px;
        font-size: 12px;
    }
}

.print-dialog-shell {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(255, 255, 255, 0.94);
    backdrop-filter: blur(28px);
    -webkit-backdrop-filter: blur(28px);
    border: 1px solid rgba(15, 23, 42, 0.08);
    z-index: 140002;
    width: min(820px, 94vw);
    box-shadow: 0 24px 48px rgba(15, 23, 42, 0.42);
    border-radius: 16px;
    overflow: hidden;
    font-family: 'Inter', system-ui, sans-serif;
    color: #0f172a;
}

.print-dialog-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 16px;
    background: linear-gradient(135deg, rgba(30, 64, 175, 0.96) 0%, rgba(14, 165, 233, 0.9) 100%);
    color: #fff;
}

.print-dialog-title {
    font-size: 15px;
    font-weight: 600;
}

.print-dialog-subtitle {
    margin-top: 4px;
    font-size: 13px;
    opacity: 0.87;
}

.print-dialog-close {
    background: none;
    border: none;
    color: inherit;
    font-size: 20px;
    cursor: pointer;
    line-height: 1;
    padding: 2px 6px;
}

.print-dialog-body {
    display: flex;
    gap: 22px;
    padding: 22px 24px;
    background: rgba(248, 250, 252, 0.92);
    max-height: 64vh;
    overflow: hidden;
}

.print-dialog-column {
    display: flex;
    flex-direction: column;
    gap: 16px;
    overflow-y: auto;
    padding-right: 4px;
}

.print-dialog-settings {
    flex: 0 0 280px;
}

.print-dialog-preview-column {
    flex: 1 1 auto;
}

.print-dialog-card,
.print-preview-card {
    background: rgba(255, 255, 255, 0.92);
    border: 1px solid rgba(148, 163, 184, 0.32);
    border-radius: 12px;
    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.6);
    padding: 16px 18px;
}

.print-card-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 12px;
}

.print-card-title {
    font-size: 13px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.6px;
    color: #1e3a8a;
}

.print-card-link {
    border: none;
    background: none;
    color: #2563eb;
    font-size: 12px;
    font-weight: 600;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    gap: 4px;
}

.print-card-link:hover {
    text-decoration: underline;
}

.print-card-content {
    display: grid;
    gap: 10px;
}

.print-card-helper {
    font-size: 12px;
    color: #475569;
    line-height: 1.4;
}

.print-card-radio-group {
    gap: 12px;
}

.print-card-radio-group label {
    display: flex;
    align-items: flex-start;
    gap: 10px;
    font-size: 13px;
    padding: 10px 12px;
    border: 1px solid rgba(148, 163, 184, 0.25);
    border-radius: 10px;
    background: rgba(248, 250, 252, 0.75);
    transition: border-color 0.2s ease, box-shadow 0.2s ease;
}

.print-card-radio-group label:hover {
    border-color: rgba(37, 99, 235, 0.4);
    box-shadow: 0 2px 8px rgba(15, 23, 42, 0.1);
}

.print-card-radio-group input[type="radio"] {
    accent-color: #2563eb;
    margin-top: 2px;
}

.radio-label {
    font-weight: 600;
}

.radio-description {
    font-size: 12px;
    color: #475569;
}

.print-card-orientation {
    display: grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap: 12px;
}

.print-orientation-btn {
    border: 1px solid rgba(148, 163, 184, 0.35);
    border-radius: 12px;
    padding: 14px 0 12px;
    font-size: 13px;
    font-weight: 600;
    background: rgba(248, 250, 252, 0.85);
    color: #1f2937;
    cursor: pointer;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 6px;
    transition: all 0.18s ease;
}

.print-orientation-btn .material-symbols-outlined {
    font-size: 28px;
}

.print-orientation-btn:hover {
    border-color: rgba(37, 99, 235, 0.5);
    box-shadow: 0 2px 8px rgba(15, 23, 42, 0.1);
}

.print-orientation-btn.active {
    border-color: rgba(37, 99, 235, 0.65) !important;
    background: linear-gradient(135deg, rgba(37, 99, 235, 0.16) 0%, rgba(14, 165, 233, 0.18) 100%) !important;
    color: #1f2937 !important;
    box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.18);
}

.print-card-options label {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 13px;
}

.print-card-options input[type="checkbox"] {
    accent-color: #2563eb;
}

.print-select,
.print-manage-printers-panel textarea {
    width: 100%;
    border-radius: 10px;
    border: 1px solid rgba(148, 163, 184, 0.4);
    padding: 12px;
    font-size: 13px;
    background: rgba(255, 255, 255, 0.95);
    color: #0f172a;
    font-family: inherit;
}

.print-manage-printers-panel {
    background: rgba(248, 250, 252, 0.95);
    border: 1px solid rgba(148, 163, 184, 0.35);
    border-radius: 10px;
    padding: 12px 14px;
    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.55);
    display: grid;
    gap: 10px;
}

.print-manage-description {
    font-size: 12px;
    color: #475569;
    line-height: 1.5;
}

.print-manage-actions {
    display: flex;
    justify-content: flex-end;
    gap: 10px;
}

.print-primary-btn {
    padding: 10px 20px;
    border-radius: 10px;
    border: none;
    background: linear-gradient(135deg, #2563eb 0%, #0ea5e9 100%);
    color: #fff;
    font-size: 13px;
    font-weight: 600;
    cursor: pointer;
    box-shadow: 0 6px 14px rgba(37, 99, 235, 0.35);
}

.print-secondary-btn {
    padding: 10px 18px;
    border-radius: 10px;
    border: 1px solid rgba(148, 163, 184, 0.45);
    background: rgba(255, 255, 255, 0.95);
    font-size: 13px;
    font-weight: 600;
    color: #475569;
    cursor: pointer;
}

.print-secondary-btn:hover,
.print-primary-btn:hover {
    transform: translateY(-1px);
}

.print-dialog-footer {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 16px 24px;
    background: rgba(241, 245, 249, 0.95);
    border-top: 1px solid rgba(148, 163, 184, 0.25);
}

.print-footer-toggle {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 12px;
    color: #475569;
}

.print-footer-toggle input[type="checkbox"] {
    accent-color: #2563eb;
}

.print-footer-actions {
    display: flex;
    gap: 12px;
}

.print-preview-card {
    padding: 18px 20px;
    display: grid;
    gap: 12px;
}

.print-preview-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.print-preview-title {
    display: flex;
    align-items: center;
    gap: 8px;
    font-weight: 600;
    font-size: 14px;
}

.print-preview-actions {
    display: inline-flex;
    gap: 6px;
}

.print-preview-action {
    width: 32px;
    height: 32px;
    border-radius: 8px;
    border: 1px solid rgba(148, 163, 184, 0.4);
    background: rgba(248, 250, 252, 0.85);
    color: #1f2937;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: default;
}

.print-preview-meta {
    font-size: 12px;
    color: #475569;
}

.print-dialog-preview-pane {
    border-radius: 14px;
    border: 1px solid rgba(148, 163, 184, 0.35);
    background: linear-gradient(160deg, rgba(248, 250, 252, 0.92) 0%, rgba(241, 245, 249, 0.92) 100%);
    overflow: hidden;
    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.6);
    min-height: 260px;
}

.print-dialog-preview-content {
    padding: 18px 20px;
    max-height: 320px;
    overflow-y: auto;
    font-size: 13px;
    line-height: 1.55;
    color: #1f2937;
}

.print-preview-warning {
    margin-top: 14px;
    background: rgba(254, 243, 199, 0.95);
    border: 1px solid rgba(251, 191, 36, 0.45);
    border-radius: 12px;
    padding: 12px 16px;
    font-size: 12px;
    color: #92400e;
}

body.dark-mode .print-dialog-shell {
    background: rgba(15, 23, 42, 0.92);
    color: #e2e8f0;
    border-color: rgba(148, 163, 184, 0.12);
    box-shadow: 0 28px 56px rgba(0, 0, 0, 0.6);
}

body.dark-mode .print-dialog-header {
    background: linear-gradient(135deg, rgba(37, 99, 235, 0.85) 0%, rgba(14, 165, 233, 0.75) 100%);
}

body.dark-mode .print-dialog-body {
    background: rgba(15, 23, 42, 0.82);
}

body.dark-mode .print-dialog-card,
body.dark-mode .print-preview-card {
    background: rgba(30, 41, 59, 0.82);
    border-color: rgba(71, 85, 105, 0.45);
    box-shadow: inset 0 1px 0 rgba(148, 163, 184, 0.12);
}

body.dark-mode .print-card-title {
    color: #bfdbfe;
}

body.dark-mode .print-card-radio-group label {
    background: rgba(30, 41, 59, 0.75);
    border-color: rgba(71, 85, 105, 0.45);
}

body.dark-mode .radio-description,
body.dark-mode .print-card-helper,
body.dark-mode .print-preview-meta {
    color: #cbd5f5;
}

body.dark-mode .print-card-options label span,
body.dark-mode .radio-label {
    color: #e2e8f0;
}

body.dark-mode .print-custom-margin-panel {
    background: rgba(30, 41, 59, 0.65);
    border-color: rgba(71, 85, 105, 0.6);
    box-shadow: inset 0 1px 0 rgba(30, 41, 59, 0.3);
}

body.dark-mode .print-custom-margin-grid label {
    color: #cbd5f5;
}

body.dark-mode .print-custom-margin-grid input[type="number"],
body.dark-mode .print-custom-margin-grid select {
    background: rgba(15, 23, 42, 0.75);
    border-color: rgba(71, 85, 105, 0.7);
    color: #e2e8f0;
}

body.dark-mode .print-custom-margin-grid input[type="number"]:focus,
body.dark-mode .print-custom-margin-grid select:focus {
    border-color: #60a5fa;
    box-shadow: 0 0 0 2px rgba(96, 165, 250, 0.25);
}

body.dark-mode .print-orientation-btn {
    background: rgba(30, 41, 59, 0.75) !important;
    color: #e2e8f0 !important;
    border-color: rgba(148, 163, 184, 0.35) !important;
}

body.dark-mode .print-orientation-btn.active {
    border-color: rgba(59, 130, 246, 0.55) !important;
    background: linear-gradient(135deg, rgba(59, 130, 246, 0.25) 0%, rgba(14, 165, 233, 0.24) 100%) !important;
    color: #f8fafc !important;
    box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.22);
}

body.dark-mode .print-select,
body.dark-mode .print-manage-printers-panel textarea {
    background: rgba(17, 24, 39, 0.85);
    color: #e2e8f0;
    border-color: rgba(71, 85, 105, 0.45);
}

body.dark-mode .print-manage-printers-panel {
    background: rgba(15, 23, 42, 0.7);
    border-color: rgba(71, 85, 105, 0.45);
    box-shadow: inset 0 1px 0 rgba(148, 163, 184, 0.12);
}

body.dark-mode .print-manage-description {
    color: #cbd5f5;
}

body.dark-mode .print-secondary-btn {
    background: rgba(30, 41, 59, 0.82);
    color: #e2e8f0;
    border-color: rgba(71, 85, 105, 0.5);
}

body.dark-mode .print-dialog-footer {
    background: rgba(17, 24, 39, 0.88);
    border-top-color: rgba(71, 85, 105, 0.45);
}

body.dark-mode .print-footer-toggle {
    color: #cbd5f5;
}

body.dark-mode .print-preview-warning {
    background: rgba(208, 138, 4, 0.16);
    border-color: rgba(234, 179, 8, 0.5);
    color: #fde68a;
}

body.dark-mode .print-preview-action {
    border-color: rgba(71, 85, 105, 0.5);
    background: rgba(30, 41, 59, 0.8);
    color: #e2e8f0;
}

body.dark-mode .print-dialog-preview-pane {
    border-color: rgba(71, 85, 105, 0.5);
    background: linear-gradient(160deg, rgba(30, 41, 59, 0.88) 0%, rgba(15, 23, 42, 0.92) 100%);
    box-shadow: inset 0 1px 0 rgba(148, 163, 184, 0.1);
}

body.dark-mode .print-dialog-preview-content {
    color: #e2e8f0;
}

.print-dialog-preview-content pre,
.print-dialog-preview-content code {
    background: rgba(15, 23, 42, 0.06);
    border-radius: 6px;
    padding: 6px 8px;
    display: block;
    overflow-x: auto;
    font-size: 12px;
    font-family: "Cascadia Code", "Fira Code", Consolas, monospace;
}

body.dark-mode .print-dialog-preview-content pre,
body.dark-mode .print-dialog-preview-content code {
    background: rgba(30, 41, 59, 0.65);
}

.print-dialog-preview-content h1,
.print-dialog-preview-content h2,
.print-dialog-preview-content h3 {
    margin-top: 0;
    color: #0f172a;
}

body.dark-mode .print-dialog-preview-content h1,
body.dark-mode .print-dialog-preview-content h2,
body.dark-mode .print-dialog-preview-content h3 {
    color: #f8fafc;
}

.print-dialog-preview-empty {
    padding: 24px 0;
    text-align: center;
    color: #94a3b8;
    font-size: 12px;
}

@media (max-width: 860px) {
    .print-dialog-body {
        flex-direction: column;
        max-height: none;
    }

    .print-dialog-column {
        max-height: none;
    }

    .print-dialog-settings {
        flex: 1 1 auto;
    }
}

.print-dialog-preview-split {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 16px;
}

.print-dialog-preview-column {
    background: rgba(255, 255, 255, 0.8);
    border: 1px solid rgba(148, 163, 184, 0.25);
    border-radius: 10px;
    padding: 12px;
    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.5);
}

.print-dialog-preview-column-title {
    font-size: 12px;
    font-weight: 600;
    color: #475569;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 10px;
}

.print-dialog-preview-rendered {
    font-size: 13px;
    line-height: 1.6;
    color: #1f2937;
}

body.dark-mode .print-dialog-preview-column {
    gap: 16px;
}

body.dark-mode .print-dialog-preview-column-title {
    color: #cbd5f5;
}

body.dark-mode .print-dialog-preview-rendered {
    color: #e2e8f0;
}

/* Accent-colored text selection */
::selection {
    background: rgba(0, 122, 204, 0.35);
    color: #ffffff;
}

::-moz-selection {
    background: rgba(0, 122, 204, 0.35);
    color: #ffffff;
}

body.dark-mode ::selection {
    background: rgba(79, 195, 247, 0.45);
    color: #0a1b26;
}

body.dark-mode ::-moz-selection {
    background: rgba(79, 195, 247, 0.45);
    color: #0a1b26;
}

body.splitter-resizing {
    cursor: col-resize !important;
    user-select: none;
}

body.splitter-resizing * {
    cursor: col-resize !important;
}

/* Modern View Mode Container */
.view-mode-container {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 4px 12px;
    background: rgba(0, 122, 204, 0.05);
    border-radius: 8px;
    border: 1px solid rgba(0, 122, 204, 0.2);
}

.view-mode-label {
    font-size: 12px;
    font-weight: 600;
    color: #007acc;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin: 0;
}

/* Modern View Toggle Buttons */
.view-toggle-modern {
    display: flex;
    gap: 8px;
}

.view-mode-btn.toolbar-btn {
    min-width: auto;
    justify-content: center;
}

.view-mode-btn.toolbar-btn .material-symbols-outlined {
    font-size: 18px;
}

.view-mode-text {
    font-weight: 600;
}

/* Dark mode for view mode container */
.dark-mode .view-mode-container {
    background: rgba(0, 122, 204, 0.15);
    border-color: rgba(0, 122, 204, 0.3);
}

.dark-mode .view-mode-label {
    color: #4fc3f7;
}

.dark-mode .view-toggle-modern {
    background: #23272a;
    box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.3);
}

.dark-mode .view-mode-btn {
    color: #b0b0b0;
}

.dark-mode .view-mode-btn:hover {
    background: rgba(255, 255, 255, 0.1);
    color: #4fc3f7;
}

.dark-mode .view-mode-btn.active {
    background: linear-gradient(135deg, #0077be 0%, #005a9e 100%);
    color: #fff;
    box-shadow: 0 2px 8px rgba(79, 195, 247, 0.3);
}

/* Responsive design for view mode */
@media (max-width: 1200px) {
    .view-mode-container {
        padding: 3px 8px;
        gap: 8px;
    }
    
    .view-mode-label {
        font-size: 11px;
    }
    
    .view-mode-btn {
        padding: 5px 10px;
        gap: 4px;
        font-size: 12px;
    }
    
    .view-mode-btn .material-symbols-outlined {
        font-size: 16px;
    }
}

@media (max-width: 768px) {
    .view-mode-label {
        display: none;
    }
    
    .view-mode-container {
        padding: 3px;
        border: none;
        background: transparent;
    }
    
    .view-mode-text {
        display: none;
    }
    
    .view-mode-btn {
        padding: 8px;
        justify-content: center;
    }
    
    .view-mode-btn .material-symbols-outlined {
        margin: 0;
    }
}

/* Smooth view mode transition animations */
.main-container {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.editor-pane,
.preview-pane {
    transition: flex 0.3s cubic-bezier(0.4, 0, 0.2, 1),
                opacity 0.3s ease;
}

.main-container.editor-only .preview-pane,
.main-container.preview-only .editor-pane {
    opacity: 0;
}

.splitter {
    transition: opacity 0.3s ease;
}

.main-container.single-pane .splitter {
    opacity: 0;
    pointer-events: none;
}

/* Modern Menu Bar Design */
.menu-bar {
    background: rgba(255, 255, 255, 0.8);
    backdrop-filter: blur(30px);
    -webkit-backdrop-filter: blur(30px);
    border-bottom: 1px solid rgba(0, 0, 0, 0.06);
    padding: 0;
    display: flex;
    align-items: stretch;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.03);
    font-size: 13px;
    font-weight: 500;
}

.menu-item {
    padding: 8px 20px;
    cursor: pointer;
    transition: all 0.25s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    border-bottom: 2px solid transparent;
    position: relative;
    color: #1f2937;
    border-radius: 4px 4px 0 0;
}

.menu-item::before {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 2px;
    background: #0078d4;
    border-radius: 2px 2px 0 0;
    transform: scaleX(0);
    transition: transform 0.25s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.menu-item:hover {
    background: rgba(0, 120, 212, 0.06);
    color: #0078d4;
}

.menu-item:hover::before {
    transform: scaleX(1);
}

.menu-item.active {
    background: rgba(0, 120, 212, 0.08);
    color: #0078d4;
    border-bottom-color: #0078d4;
    font-weight: 600;
}

.menu-item.active::before {
    transform: scaleX(1);
}

/* Fix: Dark mode for lists and blockquotes */
.dark-mode .preview-content ul,
.dark-mode .preview-content ol {
    color: #e0e0e0;
}
.dark-mode .preview-content blockquote {
    border-left: 4px solid #4fc3f7;
    background: #1a2633;
    color: #4fc3f7;
}

.dark-mode .preview-content blockquote blockquote {
    border-left-color: #22d3ee;
    background: #162029;
}

/* Fix: Dark mode for preview backgrounds */
.dark-mode .preview-content h1,
.dark-mode .preview-content h2 {
    border-bottom: 1px solid #444;
}
.dark-mode .preview-content th {
    background-color: #23272a;
    color: #e0e0e0;
}
.dark-mode .preview-content td {
    background-color: #101214;
    color: #e0e0e0;
}
/* Dark mode styles */
body.dark-mode {
    background: linear-gradient(135deg, #1a1d1e 0%, #0f1214 100%);
    color: #e0e0e0;
    color-scheme: dark;
    /* Modern scrollbar color (Firefox, Chrome 121+) */
    scrollbar-color: rgba(255, 255, 255, 0.2) transparent;
}

/* Dark mode scrollbar styling for webkit browsers */
body.dark-mode ::-webkit-scrollbar {
    width: 12px;
    height: 12px;
}

body.dark-mode ::-webkit-scrollbar-track {
    background: transparent;
}

body.dark-mode ::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.2);
    border-radius: 6px;
    border: 3px solid transparent;
    background-clip: padding-box;
}

body.dark-mode ::-webkit-scrollbar-thumb:hover {
    background: rgba(255, 255, 255, 0.3);
    background-clip: padding-box;
}

body.dark-mode ::-webkit-scrollbar-thumb:active {
    background: rgba(79, 195, 247, 0.6);
    background-clip: padding-box;
}

body.dark-mode ::-webkit-scrollbar-corner {
    background: transparent;
}
/* Dark mode menu bar */
.dark-mode .menu-bar {
    background: rgba(32, 34, 37, 0.8);
    backdrop-filter: blur(30px);
    -webkit-backdrop-filter: blur(30px);
    border-bottom-color: rgba(255, 255, 255, 0.06);
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
}

.dark-mode .menu-item {
    color: #e0e0e0;
}

.dark-mode .menu-item::before {
    background: #4fc3f7;
    border-radius: 2px 2px 0 0;
}

.dark-mode .menu-item:hover {
    background: rgba(79, 195, 247, 0.08);
    color: #4fc3f7;
}

.dark-mode .menu-item.active {
    background: rgba(79, 195, 247, 0.12);
    color: #4fc3f7;
    border-bottom-color: #4fc3f7;
}
/* Dark Mode Toolbar */
.dark-mode .toolbar {
    background: rgba(42, 45, 49, 0.9);
    backdrop-filter: blur(30px);
    -webkit-backdrop-filter: blur(30px);
    border-bottom: 1px solid rgba(255, 255, 255, 0.06);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

.dark-mode .toolbar-group {
    border-right-color: rgba(255, 255, 255, 0.1);
}

.dark-mode .toolbar-group::before {
    background: linear-gradient(to bottom, transparent, rgba(79, 195, 247, 0.2), transparent);
}

.dark-mode .toolbar-btn {
    background: rgba(60, 64, 67, 0.7);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    color: #e0e0e0;
    border-color: rgba(255, 255, 255, 0.1);
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3), 0 0 0 1px rgba(255, 255, 255, 0.05) inset;
}

.dark-mode .toolbar-btn::before {
    background: linear-gradient(135deg, rgba(79, 195, 247, 0) 0%, rgba(79, 195, 247, 0.1) 100%);
}

.dark-mode .toolbar-btn:hover {
    background: rgba(70, 74, 77, 0.9);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border-color: rgba(79, 195, 247, 0.3);
    color: #4fc3f7;
    box-shadow: 0 2px 4px rgba(79, 195, 247, 0.15), 0 0 0 1px rgba(255, 255, 255, 0.08) inset;
}

.dark-mode .toolbar-btn:active {
    background: rgba(50, 54, 57, 0.9);
    box-shadow: 0 0 0 1px rgba(79, 195, 247, 0.2) inset;
}

.dark-mode .toolbar-btn.active {
    background: rgba(79, 195, 247, 0.9);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    color: #000;
    border-color: rgba(79, 195, 247, 0.3);
    box-shadow: 0 2px 6px rgba(79, 195, 247, 0.3), 0 0 0 1px rgba(255, 255, 255, 0.2) inset;
}

.dark-mode .toolbar-btn.active:hover {
    background: rgba(100, 210, 255, 0.9);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    box-shadow: 0 3px 8px rgba(79, 195, 247, 0.4), 0 0 0 1px rgba(255, 255, 255, 0.25) inset;
}

.dark-mode .toolbar-btn .beta-badge {
    background: linear-gradient(135deg, #ffcc00 0%, #ff9900 100%);
    color: #000;
}
.dark-mode .main-container {
    background-color: #181a1b;
}
.dark-mode .editor-textarea {
    background-color: #101214;
    color: #e0e0e0;
    border: none;
    scrollbar-color: #444 #101214;
}
.dark-mode .preview-content {
    background-color: #101214;
    color: #e0e0e0;
    border-left: 1px solid #444;
    scrollbar-color: #444 #101214;
}

.dark-mode .preview-content:focus {
    outline: 2px solid rgba(255, 255, 255, 0.15);
    outline-offset: -2px;
}

.dark-mode .preview-content[contenteditable="true"]:hover {
    background-color: #1a1d1f;
}
.dark-mode .pane-header {
    background-color: #181b1d;
    color: #b0b0b0;
    border-bottom: 1px solid #444;
}
.dark-mode .splitter {
    background-color: #444;
}
.dark-mode .splitter:hover {
    background-color: #005a9e;
}
.dark-mode .status-bar {
    background-color: #23272a;
    color: #e0e0e0;
    border-top: 1px solid #444;
}
.dark-mode .preview-content pre {
    background-color: #101214;
    border: 1px solid #444;
    color: #e0e0e0;
}
.dark-mode .preview-content code {
    background-color: #1a1d1f;
    color: #e0e0e0;
    border: 1px solid #333;
}
.dark-mode .preview-content th, .dark-mode .preview-content td {
    border: 1px solid #444;
}
.dark-mode .preview-content th {
    background-color: #1e2225;
    color: #e0e0e0;
}

.dark-mode .preview-content table.table-borderless {
    border: none;
}

.dark-mode .preview-content table.table-borderless th,
.dark-mode .preview-content table.table-borderless td {
    border: none;
}

.dark-mode .preview-content table.table-striped tbody tr:nth-child(even) {
    background-color: #1a1d1f;
}

.dark-mode .preview-content table.table-header-highlight thead th {
    background: linear-gradient(180deg, #1f2d3a 0%, #19232d 100%);
    color: #4fc3f7;
}
.dark-mode .preview-content hr { border-top: 1px solid #444; }
/* Dark mode custom checkbox */
.dark-mode .preview-content li.task-item input[type="checkbox"] {
    accent-color: #4fc3f7;
}

/* Dark mode dialog and overlay styles */
.dark-mode #find-replace-bar {
    background: #181a1b;
    border-color: #444;
    color: #e0e0e0;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
}

.dark-mode #find-replace-bar input {
    background: #101214;
    color: #e0e0e0;
    border: 1px solid #444;
}

.dark-mode #find-replace-bar button {
    background: #23272a;
    color: #e0e0e0;
    border: 1px solid #444;
}

.dark-mode #find-replace-bar button:hover {
    background: #2d3136;
    border-color: #666;
}

.dark-mode #find-replace-bar select,
.dark-mode #find-replace-bar .search-history-select {
    background: #101214;
    color: #e0e0e0;
    border: 1px solid #444;
}

.dark-mode #find-replace-bar select option,
.dark-mode #find-replace-bar .search-history-select option {
    background: #101214;
    color: #e0e0e0;
}

.dark-mode #find-replace-bar label {
    color: #ccc;
}

.dark-mode #find-replace-bar .search-hints {
    color: #999;
}

/* Flags dropdown styling - Modern Windows 11 */
.flags-dropdown {
    position: relative;
    z-index: 1001;
}

.flags-toggle {
    background: #fff;
    border: 1px solid #ccc;
    color: #333;
    cursor: pointer;
    transition: all 0.2s;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.06);
    outline: none;
}

.flags-toggle:hover {
    background: #f8f9fa;
    border-color: #999;
}

.flags-toggle:active,
.flags-toggle:focus {
    background: #e9ecef;
    border-color: #007acc;
    transform: translateY(0);
}

.flags-menu {
    background: #fff;
    border: 1px solid #ccc;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    z-index: 3000;
}

.flag-option {
    transition: all 0.2s;
}

.flag-option:hover {
    background: #f8f9fa;
    transform: translateX(0);
}

.flag-option:active {
    background: #e9ecef;
    transform: translateX(0);
}

/* Dark mode for flags dropdown */
.dark-mode #find-replace-bar .flags-toggle {
    background: linear-gradient(to bottom, #2d3136 0%, #23272a 100%) !important;
    border-color: rgba(79, 195, 247, 0.2) !important;
    color: #e0e0e0 !important;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3) !important;
}

.dark-mode #find-replace-bar .flags-toggle:hover {
    background: linear-gradient(to bottom, #3a3f44 0%, #2d3136 100%) !important;
    border-color: rgba(79, 195, 247, 0.4) !important;
    box-shadow: 0 2px 6px rgba(79, 195, 247, 0.2) !important;
}

.dark-mode #find-replace-bar .flags-toggle:active,
.dark-mode #find-replace-bar .flags-toggle:focus {
    background: linear-gradient(to bottom, #2d3136 0%, #23272a 100%) !important;
    border-color: rgba(79, 195, 247, 0.5) !important;
    transform: translateY(0) !important;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3) !important;
}

.dark-mode #find-replace-bar .flags-menu {
    background: #23272a !important;
    border-color: rgba(79, 195, 247, 0.15) !important;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.4) !important;
    z-index: 3000;
}

.dark-mode .flag-option:hover {
    background: rgba(79, 195, 247, 0.08) !important;
}

.dark-mode .flag-option:active {
    background: rgba(79, 195, 247, 0.12) !important;
}

.dark-mode .flag-option div > div:first-child {
    color: #e0e0e0 !important;
}

.dark-mode .flag-option div > div:last-child {
    color: #999 !important;
}

/* Flag checkboxes styling */
.flag-checkbox {
    width: 16px;
    height: 16px;
    margin-right: 8px;
    cursor: pointer;
    accent-color: #007acc;
}

.dark-mode .flag-checkbox {
    accent-color: #4fc3f7;
}

/* Find dialog checkboxes styling */
#find-replace-bar input[type="checkbox"] {
    width: 16px;
    height: 16px;
    margin-right: 6px;
    cursor: pointer;
    accent-color: #007acc;
    vertical-align: middle;
}

.dark-mode #find-replace-bar input[type="checkbox"] {
    accent-color: #4fc3f7;
}

/* Shared dialog checkbox styling */
.dialog-checkbox {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    font-size: 13px;
    font-weight: 500;
    color: #555;
    cursor: pointer;
}

.dialog-checkbox input[type="checkbox"] {
    width: 16px;
    height: 16px;
    accent-color: #007acc;
    cursor: pointer;
}

.dark-mode .dialog-checkbox {
    color: #e0e0e0;
}

.dark-mode .dialog-checkbox input[type="checkbox"] {
    accent-color: #4fc3f7;
}

body.compact-mode .dialog-checkbox {
    font-size: 11px;
    gap: 6px;
}

body.compact-mode .dialog-checkbox input[type="checkbox"] {
    width: 14px;
    height: 14px;
}

/* Table dropdown styling */
.table-dropdown {
    position: relative;
    display: inline-block;
}

.table-menu {
    background: #fff;
    border: 1px solid #ccc;
    border-radius: 6px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    max-height: 400px;
    overflow-y: auto;
}

.menu-section {
    margin-bottom: 8px;
}

.menu-section:last-child {
    margin-bottom: 0;
}

.menu-section-title {
    font-weight: 600;
    color: #666;
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    padding: 8px 8px 4px 8px;
    margin-bottom: 4px;
    border-bottom: 1px solid #eee;
}

.menu-divider {
    height: 1px;
    background: #eee;
    margin: 8px 0;
}

.table-menu-option {
    display: flex;
    align-items: center;
    width: 100%;
    padding: 8px 12px;
    text-align: left;
    background: none;
    border: none;
    cursor: pointer;
    border-radius: 4px;
    margin-bottom: 2px;
    transition: all 0.2s ease;
    color: #333;
    font-size: 13px;
    position: relative;
}

.table-menu-option:hover:not(.disabled) {
    background: #f0f0f0;
    color: #000;
}

.table-menu-option:active:not(.disabled) {
    background: #e0e0e0;
}

.table-menu-option.disabled {
    color: #999;
    cursor: not-allowed;
    opacity: 0.6;
}

.table-menu-option.disabled:hover {
    background: none;
}

.coming-soon {
    font-size: 10px;
    color: #007acc;
    font-style: italic;
    margin-left: auto;
}

/* Dark mode for table dropdown */
.dark-mode .table-menu {
    background: #2b2b2b;
    border-color: #444;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

.dark-mode .menu-section-title {
    color: #aaa;
    border-bottom-color: #444;
}

.dark-mode .menu-divider {
    background: #444;
}

.dark-mode .table-menu-option {
    color: #ddd;
}

.dark-mode .table-menu-option:hover:not(.disabled) {
    background: #333;
    color: #fff;
}

.dark-mode .table-menu-option:active:not(.disabled) {
    background: #444;
}

.dark-mode .table-menu-option.disabled {
    color: #666;
}

.dark-mode .coming-soon {
    color: #4fc3f7;
}

/* Settings dialog dark mode styling */
.dark-mode #settings-dialog {
    background: #1a1d1e !important;
    border-color: #444 !important;
    color: #e0e0e0 !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3) !important;
}

/* Settings header dark mode */
.dark-mode #settings-dialog > div:first-child {
    background: #23272a !important;
    border-bottom-color: #444 !important;
}

.dark-mode #settings-dialog h1,
.dark-mode #settings-dialog h2,
.dark-mode #settings-dialog h3,
.dark-mode #settings-dialog h4 {
    color: #e0e0e0 !important;
}

.dark-mode #settings-dialog p,
.dark-mode #settings-dialog label,
.dark-mode #settings-dialog div {
    color: #b0b0b0 !important;
}

/* Settings sidebar dark mode */
.dark-mode #settings-dialog > div > div:first-child {
    background: #1f2327 !important;
    border-right-color: #3a3f44 !important;
}

.dark-mode #settings-dialog nav {
    background: transparent !important;
}

.dark-mode #settings-dialog .settings-nav-item {
    color: #c7cdd3 !important;
    background: transparent !important;
    border-left: 3px solid transparent !important;
    transition: background 0.2s ease, color 0.2s ease, border-color 0.2s ease;
}

.dark-mode #settings-dialog .settings-nav-item:hover {
    background: rgba(79, 195, 247, 0.08) !important;
    color: #4fc3f7 !important;
}

.dark-mode #settings-dialog .settings-nav-item:active {
    background: rgba(79, 195, 247, 0.12) !important;
}

.dark-mode #settings-dialog .settings-nav-item[style*="background:#e8f0fe"],
.dark-mode #settings-dialog .settings-nav-item[style*="background: #e8f0fe"],
.dark-mode #settings-dialog .settings-nav-item[style*="background:#E8F0FE"],
.dark-mode #settings-dialog .settings-nav-item[style*="background: #E8F0FE"] {
    background: rgba(79, 195, 247, 0.15) !important;
    color: #4fc3f7 !important;
    border-left-color: #4fc3f7 !important;
}

/* Settings sections dark mode */
.dark-mode #settings-dialog .settings-section {
    background: #1a1d1e !important;
}

.dark-mode #settings-dialog .settings-section > div > div {
    background: #23272a !important;
    border-color: #444 !important;
}

.dark-mode #settings-dialog input[type="checkbox"] {
    accent-color: #4fc3f7 !important;
}

.dark-mode #settings-dialog input[type="range"] {
    background: #444 !important;
}

.dark-mode #settings-dialog select {
    background: #444 !important;
    color: #e0e0e0 !important;
    border-color: #666 !important;
}

/* Theme buttons in settings dark mode */
.dark-mode #settings-dialog .theme-btn {
    background: #4fc3f7 !important;
    border-color: #444 !important;
    color: #23272a !important;
}

.dark-mode #settings-dialog .theme-btn:hover {
    background: #2d3136 !important;
    border-color: #666 !important;
}

/* Settings close button dark mode */
.dark-mode #settings-dialog #settings-close {
    color: #b0b0b0 !important;
}

.dark-mode #settings-dialog #settings-close:hover {
    background: rgba(255, 255, 255, 0.1) !important;
    color: #e0e0e0 !important;
}

/* Settings input fields dark mode */
.dark-mode #settings-dialog input[type="text"],
.dark-mode #settings-dialog input[type="number"],
.dark-mode #settings-dialog textarea {
    background: #23272a !important;
    border-color: #444 !important;
    color: #e0e0e0 !important;
}

/* Settings toggle switches dark mode */
.dark-mode #settings-dialog label > span {
    background-color: #23272a !important;
}



/* Font preview and related elements dark mode */
.dark-mode #settings-dialog #font-preview {
    background: #23272a !important;
    border-color: #444 !important;
    color: #e0e0e0 !important;
}

.dark-mode #settings-dialog #editor-font-preview {
    background: #23272a !important;
    border-color: #444 !important;
    color: #e0e0e0 !important;
}

.dark-mode #settings-dialog #selected-font-display {
    background: rgba(79, 195, 247, 0.15) !important;
    border-color: rgba(79, 195, 247, 0.3) !important;
}

.dark-mode #settings-dialog #selected-font-name {
    color: #4fc3f7 !important;
}

.dark-mode #settings-dialog #font-search-results {
    background: #23272a !important;
    border-color: #444 !important;
}

.dark-mode #settings-dialog .font-result-item {
    border-bottom-color: #444 !important;
}

.dark-mode #settings-dialog .select-font-btn {
    background: #4fc3f7 !important;
    color: #23272a !important;
}

.dark-mode #settings-dialog .select-font-btn:hover {
    background: #4fc3f7 !important;
}

.dark-mode #settings-dialog #search-fonts-btn {
    background: #4fc3f7 !important;
    color: #23272a !important;
}

.dark-mode #settings-dialog #search-fonts-btn:hover {
    background: #4fc3f7 !important;
}

/* Settings navigation active state dark mode */
.dark-mode #settings-dialog .settings-nav-item[style*="background:#e8f0fe"],
.dark-mode #settings-dialog .settings-nav-item[style*="background: #e8f0fe"] {
    background: rgba(79, 195, 247, 0.2) !important;
    color: #4fc3f7 !important;
    border-left-color: #4fc3f7 !important;
}

/* Material symbols icons in settings dark mode */
.dark-mode #settings-dialog .material-symbols-outlined {
    color: inherit !important;
}

.dark-mode #settings-dialog .material-symbols-outlined[style*="color:#1a73e8"] {
    color: #4fc3f7 !important;
}

.dark-mode #settings-dialog .material-symbols-outlined[style*="color:#34a853"] {
    color: #4fc3f7 !important;
}

.dark-mode #settings-dialog .material-symbols-outlined[style*="color:#ea4335"] {
    color: #4fc3f7 !important;
}

/* Clear search history button dark mode */
.dark-mode #settings-dialog #clear-search-history {
    background: #4fc3f7 !important;
    color: #23272a !important;
}

.dark-mode #settings-dialog #clear-search-history:hover {
    background: #4fc3f7 !important;
}

/* Font controls in settings dark mode */
.dark-mode #settings-dialog #font-decrease,
.dark-mode #settings-dialog #font-increase {
    background: #23272a !important;
    border-color: #444 !important;
    color: #e0e0e0 !important;
}

.dark-mode #settings-dialog #font-decrease:hover,
.dark-mode #settings-dialog #font-increase:hover {
    background: #2d3136 !important;
    border-color: #666 !important;
}

/* Settings section containers dark mode */
.dark-mode #settings-dialog [style*="background:#f8f9fa"] {
    background: #23272a !important;
}

/* ensure checked track color in dark mode */
.dark-mode #settings-dialog input[type="checkbox"]:checked + span {
    background-color: #4fc3f7 !important;
}

.dark-mode #settings-dialog [style*="background:#fff"] {
    background: #1a1d1e !important;
}

.dark-mode #settings-dialog [style*="border:1px solid #dadce0"],
.dark-mode #settings-dialog [style*="border: 1px solid #dadce0"] {
    border-color: #444 !important;
}

/* Text colors in settings dark mode */
.dark-mode #settings-dialog [style*="color:#202124"] {
    color: #e0e0e0 !important;
}

.dark-mode #settings-dialog [style*="color:#5f6368"] {
    color: #b0b0b0 !important;
}

.dark-mode #settings-dialog [style*="color:#3c4043"] {
    color: #e0e0e0 !important;
}

.dark-mode #settings-dialog [style*="color:#666"] {
    color: #b0b0b0 !important;
}

/* Find action buttons styling */
.find-action-btn {
    background: #f8f8f8;
    border: 1px solid #ccc;
    color: #333;
    padding: 6px 12px;
    border-radius: 3px;
    cursor: pointer;
    font-size: 12px;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    min-width: 32px;
    height: 28px;
}

/* Icon-only find action buttons */
.find-action-btn .material-symbols-outlined {
    font-size: 18px;
}

.find-action-btn:hover {
    background: #e8e8e8;
    border-color: #999;
}

.find-action-btn:active {
    background: #d0d0d0;
}

/* Dark mode for find action buttons */
.dark-mode .find-action-btn {
    background: #23272a;
    border-color: #444;
    color: #e0e0e0;
}

.dark-mode .find-action-btn:hover {
    background: #2d3136;
    border-color: #666;
}

.dark-mode .find-action-btn:active {
    background: #1a1d1f;
}

/* Table alignment dropdown styling */
.table-align-dropdown {
    position: relative;
    display: inline-block;
}

.table-align-menu {
    background: #fff;
    border: 1px solid #ccc;
    border-radius: 3px;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.12);
}

.table-align-option {
    display: block;
    width: 100%;
    padding: 6px 8px;
    text-align: left;
    background: none;
    border: none;
    cursor: pointer;
    border-radius: 3px;
    margin-bottom: 2px;
    transition: background-color 0.2s ease;
    color: #333;
}

.table-align-option:hover {
    background: #f0f0f0;
}

.table-align-option:last-child {
    margin-bottom: 0;
}

/* Dark mode for table alignment dropdown */
.dark-mode .table-align-menu {
    background: #2b2b2b;
    border-color: #444;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
}


.dark-mode #link-image-dialog {
    background: #181a1b;
    border-color: #444;
    color: #e0e0e0;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

.dark-mode #link-image-dialog input {
    background: #101214;
    color: #e0e0e0;
    border: 1px solid #444;
}

.dark-mode #link-image-dialog button {
    background: #23272a;
    color: #e0e0e0;
    border: 1px solid #444;
    transition: all 0.2s;
}

.dark-mode #link-image-dialog button:hover {
    background: #2d3136;
    border-color: #666;
}

.dark-mode #custom-alert {
    background: #181a1b;
    border-color: #444;
    color: #e0e0e0;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

.dark-mode #custom-alert button {
    background: #23272a;
    color: #e0e0e0;
    border: 1px solid #444;
    transition: all 0.2s;
}

.dark-mode #custom-alert button:hover {
    background: #2d3136;
    border-color: #666;
}

.dark-mode #popup-overlay {
    background: rgba(0, 0, 0, 0.5);
}

/*
 * Styles for Markdown Editor
 * Extracted from markdown_editor.html for better maintainability
 */

@import url('https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0');

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Segoe UI Variable', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
    height: 100vh;
    display: flex;
    flex-direction: column;
    color-scheme: light;
    position: relative;
    overflow-x: visible;
}

/* Beta badge for menu items */
.menu-beta-badge {
    font-size: 9px;
    background: #ffdf5d;
    color: #222;
    padding: 1px 5px;
    border-radius: 999px;
    text-transform: uppercase;
    font-weight: 700;
    line-height: 1.2;
    vertical-align: middle;
}

.dark-mode .menu-beta-badge {
    background: #ffd94b;
    color: #111;
}

/* Modern Toolbar Design */
.toolbar {
    background: rgba(249, 249, 249, 0.9);
    backdrop-filter: blur(30px);
    -webkit-backdrop-filter: blur(30px);
    border-bottom: 1px solid rgba(0, 0, 0, 0.06);
    padding: 10px 16px;
    display: flex;
    align-items: center;
    gap: 8px;
    flex-wrap: wrap;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.03);
    position: relative;
    z-index: 10000;
    overflow: visible;
}

/* Toolbar Group Styling */
.toolbar-group {
    display: flex;
    gap: 4px;
    padding: 4px 12px 4px 4px;
    border-right: 1px solid rgba(0, 0, 0, 0.06);
    position: relative;
    overflow: visible;
}

.toolbar-group:last-child {
    border-right: none;
}

.toolbar-group::before {
    content: '';
    position: absolute;
    right: -1px;
    top: 50%;
    transform: translateY(-50%);
    height: 60%;
    width: 1px;
    background: linear-gradient(to bottom, transparent, rgba(0, 122, 204, 0.2), transparent);
}

.toolbar-group:last-child::before {
    display: none;
}

/* Modern Toolbar Buttons */
.toolbar-btn {
    background: rgba(255, 255, 255, 0.7);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border: 1px solid rgba(0, 0, 0, 0.08) !important;
    padding: 7px 14px;
    cursor: pointer;
    font-size: 13px;
    font-weight: 500;
    border-radius: 6px;
    transition: all 0.25s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    display: flex;
    align-items: center;
    gap: 6px;
    color: #1f2937;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.06), 0 0 0 1px rgba(255, 255, 255, 0.5) inset;
    position: relative;
    overflow: hidden;
    outline: none !important;
}

/* Prevent browser validation red borders on all buttons */
button:invalid,
button:hover:invalid,
.toolbar-btn:invalid,
.toolbar-btn:hover:invalid {
    border-color: rgba(0, 0, 0, 0.08) !important;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.06), 0 0 0 1px rgba(255, 255, 255, 0.5) inset !important;
    outline: none !important;
}

.toolbar-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, rgba(0, 122, 204, 0) 0%, rgba(0, 122, 204, 0.05) 100%);
    opacity: 0;
    transition: opacity 0.2s;
}

.toolbar-btn:hover {
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border-color: rgba(0, 120, 212, 0.25) !important;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08), 0 0 0 1px rgba(255, 255, 255, 0.7) inset !important;
    transform: translateY(-0.5px);
    color: #0078d4;
    outline: none !important;
}

.toolbar-btn:hover::before {
    opacity: 1;
}

.toolbar-btn:active {
    transform: translateY(0);
    box-shadow: 0 0 0 1px rgba(0, 120, 212, 0.2) inset;
    background: rgba(243, 244, 246, 0.8);
}

.toolbar-btn.active {
    background: rgba(0, 120, 212, 0.9);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    color: white;
    border-color: rgba(0, 120, 212, 0.3);
    box-shadow: 0 2px 6px rgba(0, 120, 212, 0.3), 0 0 0 1px rgba(255, 255, 255, 0.2) inset;
    font-weight: 600;
}

.toolbar-btn.active:hover {
    background: rgba(16, 137, 229, 0.9);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    transform: translateY(-0.5px);
    box-shadow: 0 3px 8px rgba(0, 120, 212, 0.35), 0 0 0 1px rgba(255, 255, 255, 0.25) inset;
}

/* Icon styling */
.toolbar-btn .material-symbols-outlined {
    font-size: 20px;
    transition: transform 0.2s;
}

.toolbar-btn:hover .material-symbols-outlined {
    transform: scale(1.1);
}

/* Icon-only buttons */
.toolbar-btn.icon-only {
    padding: 8px;
    justify-content: center;
    min-width: 36px;
    min-height: 36px;
}

.toolbar-btn.icon-only .material-symbols-outlined {
    font-size: 20px;
    margin: 0;
}

/* Dropdown arrow */
.dropdown-arrow {
    font-size: 10px;
    margin-left: 4px;
    opacity: 0.7;
    transition: transform 0.2s;
}

.toolbar-btn:hover .dropdown-arrow {
    opacity: 1;
    transform: translateY(1px);
}

/* Beta badge modern styling */
.toolbar-btn .beta-badge {
    margin-left: 6px;
    font-size: 9px;
    background: linear-gradient(135deg, #ffd700 0%, #ffb700 100%);
    color: #1a1a1a;
    padding: 2px 6px;
    border-radius: 10px;
    font-weight: 700;
    line-height: 1;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
}

/* Category-based color accents */
.toolbar-group[data-category="file"] .toolbar-btn:hover {
    border-color: rgba(25, 135, 84, 0.4);
}

.toolbar-group[data-category="edit"] .toolbar-btn:hover {
    border-color: rgba(0, 122, 204, 0.4);
}

.toolbar-group[data-category="view"] .toolbar-btn:hover {
    border-color: rgba(108, 92, 231, 0.4);
}

.toolbar-group[data-category="help"] .toolbar-btn:hover {
    border-color: rgba(220, 53, 69, 0.4);
}

/* Responsive toolbar design */
@media (max-width: 1400px) {
    .toolbar {
        padding: 8px 12px;
        gap: 6px;
    }
    
    .toolbar-group {
        padding: 3px 10px 3px 3px;
        gap: 3px;
    }
    
    .toolbar-btn {
        padding: 6px 12px;
        font-size: 12px;
    }
    
    .toolbar-btn .material-symbols-outlined {
        font-size: 18px;
    }
    
    .toolbar-btn.icon-only {
        padding: 7px;
        min-width: 32px;
        min-height: 32px;
    }
}

@media (max-width: 1024px) {
    .toolbar {
        padding: 6px 10px;
        gap: 4px;
    }
    
    .toolbar-group {
        padding: 2px 8px 2px 2px;
        gap: 2px;
    }
    
    .toolbar-btn {
        padding: 5px 10px;
        font-size: 11px;
        gap: 4px;
    }
    
    .toolbar-btn .material-symbols-outlined {
        font-size: 16px;
    }
    
    .toolbar-btn.icon-only {
        padding: 6px;
        min-width: 28px;
        min-height: 28px;
    }
    
    .toolbar-btn.icon-only .material-symbols-outlined {
        font-size: 16px;
    }
}

@media (max-width: 768px) {
    .toolbar-group::before {
        display: none;
    }
    
    .toolbar-btn span:not(.material-symbols-outlined):not(.beta-badge) {
        display: none;
    }
    
    .toolbar-btn {
        padding: 6px;
        min-width: 32px;
        justify-content: center;
    }
    
    .toolbar-btn .material-symbols-outlined {
        margin: 0;
    }
}

/* Toolbar loading animation */
@keyframes toolbarSlideIn {
    from {
        transform: translateY(-100%);
        opacity: 0;
    }
    to {
        transform: translateY(0);
        opacity: 1;
    }
}

.toolbar {
    animation: toolbarSlideIn 0.3s ease-out;
}

/* Button press animation */
@keyframes buttonPress {
    0%, 100% {
        transform: scale(1);
    }
    50% {
        transform: scale(0.95);
    }
}

.toolbar-btn:active {
    animation: buttonPress 0.1s ease;
}

/* Glow effect for active buttons */
@keyframes activeGlow {
    0%, 100% {
        box-shadow: 0 2px 8px rgba(0, 122, 204, 0.4), 0 0 0 2px rgba(0, 122, 204, 0.1);
    }
    50% {
        box-shadow: 0 2px 12px rgba(0, 122, 204, 0.6), 0 0 0 3px rgba(0, 122, 204, 0.2);
    }
}

.toolbar-btn.active {
    animation: activeGlow 2s ease-in-out infinite;
}

/* Focus states for accessibility */
.toolbar-btn:focus {
    outline: none;
    box-shadow: 0 0 0 3px rgba(0, 122, 204, 0.3);
}

.toolbar-btn:focus:not(:hover) {
    border-color: rgba(0, 122, 204, 0.5);
}

.toolbar-btn.active:focus {
    box-shadow: 0 2px 8px rgba(0, 122, 204, 0.4), 
                0 0 0 3px rgba(0, 122, 204, 0.3);
}

/* Disabled state */
.toolbar-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    pointer-events: none;
}

/* Tooltip improvements */
.toolbar-btn[title]:hover::after {
    content: attr(title);
    position: absolute;
    bottom: -35px;
    left: 50%;
    transform: translateX(-50%);
    padding: 6px 10px;
    background: rgba(0, 0, 0, 0.9);
    color: white;
    font-size: 11px;
    border-radius: 4px;
    white-space: nowrap;
    z-index: 1000;
    pointer-events: none;
    animation: tooltipFadeIn 0.2s ease;
}

.toolbar-btn[title]:hover::before {
    content: '';
    position: absolute;
    bottom: -5px;
    left: 50%;
    transform: translateX(-50%);
    border: 5px solid transparent;
    border-bottom-color: rgba(0, 0, 0, 0.9);
    z-index: 1000;
    pointer-events: none;
    animation: tooltipFadeIn 0.2s ease;
}

@keyframes tooltipFadeIn {
    from {
        opacity: 0;
        transform: translateX(-50%) translateY(-5px);
    }
    to {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
    }
}

/* Dark mode focus states */
.dark-mode .toolbar-btn:focus {
    box-shadow: 0 0 0 3px rgba(79, 195, 247, 0.3);
}

.dark-mode .toolbar-btn:focus:not(:hover) {
    border-color: rgba(79, 195, 247, 0.5);
}

.dark-mode .toolbar-btn.active:focus {
    box-shadow: 0 2px 8px rgba(79, 195, 247, 0.4), 
                0 0 0 3px rgba(79, 195, 247, 0.3);
}

/* Modern Dialog Styling */
#custom-alert, #image-cap-dialog, #link-image-dialog, #theme-dialog, #find-replace-bar {
    background: rgba(255, 255, 255, 0.9) !important;
    backdrop-filter: blur(40px) !important;
    -webkit-backdrop-filter: blur(40px) !important;
    border: 1px solid rgba(0, 0, 0, 0.06) !important;
    border-radius: 8px !important;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12), 
                0 0 0 1px rgba(255, 255, 255, 0.5) inset !important;
    animation: dialogFadeIn 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94) !important;
}

@keyframes dialogFadeIn {
    from {
        opacity: 0;
        transform: translate(-50%, -48%) scale(0.95);
    }
    to {
        opacity: 1;
        transform: translate(-50%, -50%) scale(1);
    }
}

/* Popup header layout */
.popup-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
}

.popup-header .popup-title {
    font-size: 15px;
    font-weight: 600;
    color: inherit;
}

.popup-header .close-btn {
    margin-left: auto;
}

/* Dialog Headers */
#settings-dialog > div:first-child,
#custom-alert > div:first-child,
#image-cap-dialog > div:first-child,
#link-image-dialog > div:first-child,
#theme-dialog-header,
#find-replace-header,
.popup-header {
    background: rgba(0, 120, 212, 0.95) !important;
    backdrop-filter: blur(20px) !important;
    -webkit-backdrop-filter: blur(20px) !important;
    padding: 12px 16px !important;
    border-radius: 8px 8px 0 0 !important;
    box-shadow: 0 1px 0 rgba(255, 255, 255, 0.2) inset !important;
}

#find-replace-header {
    cursor: move;
}

#theme-dialog-header {
    padding: 14px 20px !important;
    border-radius: 14px 14px 0 0 !important;
    cursor: move;
}

/* Make settings title bar light in light mode only (keeps other dialog headers same) */
body:not(.dark-mode) #settings-dialog > div:first-child {
    background: rgba(255, 255, 255, 0.95) !important;
    color: #1f2937 !important;
    border-bottom: 1px solid rgba(0, 0, 0, 0.06) !important;
    box-shadow: 0 1px 0 rgba(0, 0, 0, 0.03) inset !important;
}


/* Dialog Content */
#custom-alert > div:last-child,
#image-cap-dialog > div:last-child,
#link-image-dialog > div:last-child {
    padding: 24px !important;
}

/* Popup buttons */
.popup-actions {
    display: flex;
    justify-content: flex-end;
    gap: 8px;
}

.popup-actions.center {
    justify-content: center;
}

.popup-btn {
    background: rgba(255, 255, 255, 0.82);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border: 1px solid rgba(0, 0, 0, 0.08) !important;
    padding: 8px 20px;
    border-radius: 6px;
    font-size: 13px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.25s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.06), 0 0 0 1px rgba(255, 255, 255, 0.5) inset;
    outline: none !important;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    color: #1f2937;
}

.popup-btn.secondary {
    color: #1f2937;
}

.popup-btn.primary {
    background: rgba(0, 120, 212, 0.95) !important;
    color: #fff !important;
    border: 1px solid rgba(0, 120, 212, 0.2) !important;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1), 0 0 0 1px rgba(255, 255, 255, 0.2) inset !important;
}

.popup-btn:hover {
    background: rgba(255, 255, 255, 0.95);
    border-color: rgba(0, 120, 212, 0.2) !important;
    transform: translateY(-0.5px);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.08), 0 0 0 1px rgba(255, 255, 255, 0.7) inset !important;
}

.popup-btn.primary:hover {
    background: rgba(16, 137, 229, 0.95) !important;
}

.popup-btn:active {
    transform: translateY(0);
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.06), 0 0 0 1px rgba(255, 255, 255, 0.5) inset !important;
}

.popup-btn.primary:active {
    background: rgba(10, 109, 182, 0.95) !important;
}

.popup-btn:disabled {
    opacity: 0.55;
    cursor: not-allowed;
    box-shadow: none;
}

.popup-btn.danger {
    background: rgba(234, 67, 53, 0.95) !important;
    color: #fff !important;
    border: 1px solid rgba(234, 67, 53, 0.3) !important;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.12), 0 0 0 1px rgba(255, 255, 255, 0.2) inset !important;
}

.popup-btn.danger:hover {
    background: rgba(246, 80, 65, 0.97) !important;
    border-color: rgba(234, 67, 53, 0.4) !important;
}

.popup-btn.danger:active {
    background: rgba(217, 54, 43, 0.95) !important;
}

.dark-mode .popup-btn {
    background: rgba(54, 58, 63, 0.9);
    border: 1px solid rgba(255, 255, 255, 0.12) !important;
    color: #e2e8f0;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.4), 0 0 0 1px rgba(255, 255, 255, 0.05) inset;
}

.dark-mode .popup-btn.secondary {
    color: #e2e8f0;
}

.dark-mode .popup-btn.primary {
    background: rgba(79, 195, 247, 0.95) !important;
    border: 1px solid rgba(79, 195, 247, 0.35) !important;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.45), 0 0 0 1px rgba(255, 255, 255, 0.06) inset !important;
    color: #0b1324 !important;
}

.dark-mode .popup-btn:hover {
    background: rgba(66, 70, 76, 0.95);
    border-color: rgba(79, 195, 247, 0.4) !important;
    box-shadow: 0 2px 6px rgba(79, 195, 247, 0.2), 0 0 0 1px rgba(255, 255, 255, 0.08) inset !important;
}

.dark-mode .popup-btn.primary:hover {
    background: rgba(96, 208, 255, 0.95) !important;
}

.dark-mode .popup-btn:active {
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.35), 0 0 0 1px rgba(255, 255, 255, 0.05) inset !important;
}

.dark-mode .popup-btn.primary:active {
    background: rgba(63, 175, 224, 0.95) !important;
}

.dark-mode .popup-btn:disabled {
    opacity: 0.45;
    box-shadow: none;
}

.dark-mode .popup-btn.danger {
    background: rgba(229, 72, 66, 0.96) !important;
    border: 1px solid rgba(255, 255, 255, 0.12) !important;
    color: #0b1324 !important;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.45), 0 0 0 1px rgba(255, 255, 255, 0.08) inset !important;
}

.dark-mode .popup-btn.danger:hover {
    background: rgba(242, 96, 90, 0.98) !important;
    border-color: rgba(255, 255, 255, 0.18) !important;
}

.dark-mode .popup-btn.danger:active {
    background: rgba(214, 59, 53, 0.95) !important;
}

/* Prevent validation red borders on dialog buttons */
#custom-alert button:invalid,
#custom-alert button:hover:invalid,
#image-cap-dialog button:invalid,
#image-cap-dialog button:hover:invalid,
#link-image-dialog button:invalid,
#link-image-dialog button:hover:invalid,
#theme-dialog-cancel:invalid,
#theme-dialog-cancel:hover:invalid,
#theme-dialog-apply:invalid,
#theme-dialog-apply:hover:invalid {
    border-color: rgba(0, 0, 0, 0.08) !important;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.06), 0 0 0 1px rgba(255, 255, 255, 0.5) inset !important;
    outline: none !important;
}

#custom-alert button:hover,
#image-cap-dialog button:hover,
#link-image-dialog button:hover,
#theme-dialog-cancel:hover,
#theme-dialog-apply:hover {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border-color: rgba(0, 120, 212, 0.2) !important;
    transform: translateY(-0.5px);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.08), 0 0 0 1px rgba(255, 255, 255, 0.7) inset !important;
    outline: none !important;
}

#theme-dialog-apply,
#image-cap-ok,
#dialog-ok,
#custom-alert-ok {
    background: rgba(0, 120, 212, 0.95) !important;
    backdrop-filter: blur(10px) !important;
    -webkit-backdrop-filter: blur(10px) !important;
    color: white !important;
    border: 1px solid rgba(0, 120, 212, 0.2) !important;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1), 0 0 0 1px rgba(255, 255, 255, 0.2) inset !important;
}

#theme-dialog-apply:hover,
#image-cap-ok:hover,
#dialog-ok:hover,
#custom-alert-ok:hover {
    background: rgba(16, 137, 229, 0.95) !important;
    backdrop-filter: blur(10px) !important;
    -webkit-backdrop-filter: blur(10px) !important;
    transform: translateY(-0.5px) !important;
    box-shadow: 0 2px 6px rgba(0, 120, 212, 0.3), 0 0 0 1px rgba(255, 255, 255, 0.25) inset !important;
}

/* Dialog Inputs */
#image-cap-dialog input,
#link-image-dialog input,
#find-replace-bar input {
    padding: 10px 12px !important;
    background: rgba(255, 255, 255, 0.9) !important;
    border: 1px solid rgba(0, 0, 0, 0.1) !important;
    border-radius: 4px !important;
    font-size: 14px !important;
    transition: all 0.25s !important;
}

/* Prevent browser validation red borders */
#image-cap-dialog input:invalid,
#link-image-dialog input:invalid,
#find-replace-bar input:invalid,
button:invalid,
button:hover:invalid {
    border-color: rgba(0, 0, 0, 0.1) !important;
    box-shadow: none !important;
    outline: none !important;
}

#image-cap-dialog input:focus,
#link-image-dialog input:focus,
#find-replace-bar input:focus {
    border-color: rgba(0, 120, 212, 0.4) !important;
    box-shadow: 0 0 0 2px rgba(0, 120, 212, 0.1), 0 1px 2px rgba(0, 0, 0, 0.05) !important;
    outline: none !important;
    background: rgba(255, 255, 255, 1) !important;
}

/* Find-Replace specific styling */
#find-replace-bar button {
    background: linear-gradient(to bottom, #ffffff 0%, #f5f5f5 100%);
    border: 1px solid rgba(0, 0, 0, 0.15) !important;
    padding: 8px 16px;
    border-radius: 6px;
    font-size: 13px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    outline: none !important;
}

/* Prevent browser validation red borders on buttons */
#find-replace-bar button:invalid,
#find-replace-bar button:hover:invalid,
button:invalid,
button:hover:invalid {
    border-color: rgba(0, 0, 0, 0.15) !important;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1) !important;
    outline: none !important;
}

#find-replace-bar button:hover {
    background: linear-gradient(to bottom, #fff 0%, #f0f7ff 100%);
    border-color: rgba(0, 122, 204, 0.4) !important;
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(0, 122, 204, 0.15) !important;
}

#find-replace-bar #find-close {
    background: none !important;
    border: none !important;
    padding: 0 !important;
    box-shadow: none !important;
}

#find-replace-bar #find-close:hover {
    transform: scale(1.1) !important;
}

#find-replace-bar label {
    font-size: 13px;
    font-weight: 500;
    color: #555;
}

#find-replace-bar #match-count {
    font-size: 12px;
    color: #007acc;
    font-weight: 600;
}

.dark-mode #find-replace-bar button {
    background: linear-gradient(to bottom, #2d3136 0%, #23272a 100%);
    border-color: rgba(255, 255, 255, 0.15);
    color: #e0e0e0;
}

.dark-mode #find-replace-bar button:hover {
    background: linear-gradient(to bottom, #3a3f45 0%, #2d3136 100%);
    border-color: rgba(79, 195, 247, 0.5);
}

.dark-mode #find-replace-bar label {
    color: #e0e0e0;
}

.dark-mode #find-replace-bar #match-count {
    color: #4fc3f7;
}

/* Popup Overlay */
#popup-overlay {
    background: rgba(0, 0, 0, 0.3) !important;
    backdrop-filter: blur(4px) !important;
    -webkit-backdrop-filter: blur(4px) !important;
    z-index: 129000 !important;
    animation: overlayFadeIn 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

@keyframes overlayFadeIn {
    from {
        opacity: 0;
    }
    to {
        opacity: 1;
    }
}

/* Large Popups */
#help-popup, #changelog-popup, #extensions-dialog {
    background: rgba(255, 255, 255, 0.95) !important;
    backdrop-filter: blur(40px) !important;
    -webkit-backdrop-filter: blur(40px) !important;
    border: 1px solid rgba(0, 0, 0, 0.06) !important;
    border-radius: 8px !important;
    box-shadow: 0 16px 32px rgba(0, 0, 0, 0.15), 0 0 0 1px rgba(255, 255, 255, 0.5) inset !important;
    animation: popupSlideIn 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94) !important;
}

@keyframes popupSlideIn {
    from {
        opacity: 0;
        transform: translateX(-50%) translateY(-20px);
    }
    to {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
    }
}

/* Dark Mode Dialogs */
.dark-mode #custom-alert,
.dark-mode #image-cap-dialog,
.dark-mode #link-image-dialog,
.dark-mode #theme-dialog,
.dark-mode #find-replace-bar {
    background: rgba(42, 45, 49, 0.95) !important;
    backdrop-filter: blur(40px) !important;
    -webkit-backdrop-filter: blur(40px) !important;
    border: 1px solid rgba(255, 255, 255, 0.06) !important;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5), 
                0 0 0 1px rgba(255, 255, 255, 0.05) inset !important;
}

.dark-mode #custom-alert > div:first-child,
.dark-mode #image-cap-dialog > div:first-child,
.dark-mode #link-image-dialog > div:first-child,
.dark-mode #theme-dialog-header,
.dark-mode #find-replace-header,
.dark-mode .popup-header {
    background: rgba(79, 195, 247, 0.95) !important;
    backdrop-filter: blur(20px) !important;
    -webkit-backdrop-filter: blur(20px) !important;
    color: inherit !important;
    box-shadow: 0 1px 0 rgba(255, 255, 255, 0.2) inset !important;
}

.dark-mode #image-cap-dialog input,
.dark-mode #link-image-dialog input,
.dark-mode #find-replace-bar input {
    background: rgba(32, 34, 37, 0.9) !important;
    color: #e0e0e0 !important;
    border-color: rgba(255, 255, 255, 0.1) !important;
}

.dark-mode #find-replace-bar input:focus {
    border-color: rgba(79, 195, 247, 0.4) !important;
    box-shadow: 0 0 0 2px rgba(79, 195, 247, 0.15), 0 1px 2px rgba(0, 0, 0, 0.2) !important;
    background: rgba(32, 34, 37, 1) !important;
}

.dark-mode #help-popup,
.dark-mode #changelog-popup,
.dark-mode #extensions-dialog {
    background: rgba(42, 45, 49, 0.95) !important;
    backdrop-filter: blur(40px) !important;
    -webkit-backdrop-filter: blur(40px) !important;
}

/* Compact Mode - Reduces all UI elements */
body.compact-mode .menu-bar {
    font-size: 11px;
}

body.compact-mode .menu-item {
    padding: 6px 14px;
}

body.compact-mode .toolbar {
    padding: 4px 10px;
    gap: 4px;
}

body.compact-mode .toolbar-group {
    padding: 3px 8px 3px 3px;
    gap: 3px;
}

body.compact-mode .toolbar-btn {
    padding: 4px 8px;
    font-size: 10.5px;
    border-radius: 4px;
}

body.compact-mode .toolbar-btn .material-symbols-outlined {
    font-size: 15px;
}

body.compact-mode .toolbar-btn.icon-only {
    padding: 5px;
    min-width: 26px;
    min-height: 26px;
}

body.compact-mode .toolbar-btn.icon-only .material-symbols-outlined {
    font-size: 15px;
}

body.compact-mode .view-mode-container {
    padding: 3px 8px;
    gap: 8px;
}

body.compact-mode .view-mode-label {
    font-size: 10px;
}

body.compact-mode .view-toggle-modern {
    padding: 2px;
}

body.compact-mode .view-mode-btn {
    padding: 4px 8px;
    font-size: 11px;
    gap: 4px;
}

body.compact-mode .view-mode-btn .material-symbols-outlined {
    font-size: 16px;
}

/* Compact mode: scale history / undo-redo dropdowns and lists smaller for tight UI */
body.compact-mode .search-history-menu,
body.compact-mode .search-history-list,
body.compact-mode .search-history-item,
body.compact-mode .search-history-header,
body.compact-mode .search-history-title,
body.compact-mode .search-history-toggle,
body.compact-mode .search-history-icon,
body.compact-mode .search-history-arrow,
body.compact-mode .undo-history-menu,
body.compact-mode .undo-history-list,
body.compact-mode .undo-history-item {
    /* tighter, smaller text for compact mode */
    font-size: 10px !important;
    line-height: 1.1 !important;
}

body.compact-mode .search-history-menu,
body.compact-mode .undo-history-menu {
    /* narrower, shorter menus */
    min-width: 140px !important;
    max-width: 260px !important;
    max-height: 180px !important;
    padding: 4px !important;
    border-radius: 6px !important;
}

body.compact-mode .search-history-list,
body.compact-mode .undo-history-list {
    padding: 4px 2px !important;
}

body.compact-mode .search-history-item,
body.compact-mode .undo-history-item {
    padding: 4px 6px !important;
    margin: 2px 0 !important;
    border-radius: 4px !important;
}

/* smaller icons in compact mode */
body.compact-mode .search-history-icon,
body.compact-mode .undo-history-item .material-symbols-outlined,
body.compact-mode .search-history-arrow {
    font-size: 14px !important;
}

/* ensure the toggle/button for history doesn't overflow and uses smaller text */
body.compact-mode #search-history-toggle,
body.compact-mode .search-history-toggle {
    padding: 2px 6px !important;
    font-size: 10px !important;
}


body.compact-mode .pane-header {
    padding: 7px 12px;
    font-size: 11px;
}

body.compact-mode .pane-header::before {
    width: 3px;
}

body.compact-mode .status-bar {
    padding: 4px 12px;
    font-size: 11px;
    min-height: 24px;
}

body.compact-mode #status-right span {
    padding: 0;
    font-size: 10px;
}

body.compact-mode .editor-textarea {
    padding: 16px;
    font-size: 13px;
    line-height: 1.5;
}

body.compact-mode .preview-content {
    padding: 16px;
    font-size: 13px;
    line-height: 1.5;
}

body.compact-mode .splitter {
    width: 4px;
}

body.compact-mode .splitter:hover {
    width: 6px;
}

body.compact-mode .splitter::before {
    height: 30px;
}

body.compact-mode .splitter:hover::before {
    height: 45px;
}

body.compact-mode ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}

body.compact-mode .beta-badge {
    font-size: 8px;
    padding: 1px 4px;
}

body.compact-mode .dropdown-arrow {
    font-size: 8px;
}

/* Compact mode for dialogs */
body.compact-mode #custom-alert,
body.compact-mode #image-cap-dialog,
body.compact-mode #link-image-dialog {
    width: 380px !important;
}

body.compact-mode #theme-dialog {
    width: 1160px !important;
}

body.compact-mode .theme-preview-card .theme-preview {
    height: 100px !important;
}

body.compact-mode .theme-preview-card .theme-preview > div:last-child {
    margin-top: 48px !important;
}

body.compact-mode .theme-preview-card > div:last-child {
    padding: 10px !important;
}

body.compact-mode .theme-preview-card > div:last-child > div:first-child {
    font-size: 13px !important;
}

body.compact-mode .theme-preview-card > div:last-child > div:last-child {
    font-size: 10px !important;
}

body.compact-mode #find-replace-bar {
    width: 520px !important;
    overflow: visible !important;
}

body.compact-mode #theme-dialog {
    overflow: visible !important;
}

/* Theme dialog scrollable content */
.theme-dialog-content {
    scrollbar-width: thin;
    scrollbar-color: rgba(0, 122, 204, 0.3) transparent;
}

.theme-dialog-content::-webkit-scrollbar {
    width: 8px;
}

.theme-dialog-content::-webkit-scrollbar-track {
    background: transparent;
}

.theme-dialog-content::-webkit-scrollbar-thumb {
    background-color: rgba(0, 122, 204, 0.3);
    border-radius: 4px;
    transition: background-color 0.2s;
}

.theme-dialog-content::-webkit-scrollbar-thumb:hover {
    background-color: rgba(0, 122, 204, 0.5);
}

/* Dark mode scrollbar for theme dialog */
.dark-mode .theme-dialog-content {
    scrollbar-color: rgba(79, 195, 247, 0.3) transparent;
}

.dark-mode .theme-dialog-content::-webkit-scrollbar-thumb {
    background-color: rgba(79, 195, 247, 0.3);
}

.dark-mode .theme-dialog-content::-webkit-scrollbar-thumb:hover {
    background-color: rgba(79, 195, 247, 0.5);
}

body.compact-mode #custom-alert > div:first-child,
body.compact-mode #image-cap-dialog > div:first-child,
body.compact-mode #link-image-dialog > div:first-child,
body.compact-mode #theme-dialog-header,
body.compact-mode #find-replace-header {
    padding: 6px 10px !important;
    font-size: 12px;
    cursor: move !important;
}

/* Ensure draggable dialogs maintain proper behavior in compact mode */
body.compact-mode .draggable-dialog {
    user-select: none;
    transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

body.compact-mode #theme-dialog-header,
body.compact-mode #find-replace-header {
    user-select: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    cursor: move !important;
}

/* Compact mode: slimmer popup title bars and smaller close buttons */
body.compact-mode .popup-header {
    padding: 6px 10px !important;
    font-size: 12px !important;
}

body.compact-mode .popup-header .close-btn {
    font-size: 18px !important;
    padding: 2px 6px !important;
    line-height: 1 !important;
}

/* Compact mode: specific dialog close buttons */
body.compact-mode #find-close {
    font-size: 16px !important;
    padding: 4px !important;
    min-width: 26px !important;
    min-height: 26px !important;
    line-height: 1 !important;
}

body.compact-mode #settings-dialog .close-btn {
    font-size: 18px !important;
    padding: 2px 6px !important;
    line-height: 1 !important;
}

body.compact-mode #link-image-dialog .close-btn {
    font-size: 16px !important;
    padding: 2px 6px !important;
    line-height: 1 !important;
}

body.compact-mode #dialog-title-close {
    font-size: 16px !important;
    padding: 4px !important;
    min-width: 26px !important;
    min-height: 26px !important;
    line-height: 1 !important;
}

body.compact-mode #image-cap-close {
    font-size: 16px !important;
    padding: 4px !important;
    min-width: 26px !important;
    min-height: 26px !important;
    line-height: 1 !important;
}

/* Prevent text selection during drag in compact mode */
body.compact-mode #theme-dialog-header *,
body.compact-mode #find-replace-header * {
    pointer-events: none;
}

body.compact-mode #theme-dialog-header button,
body.compact-mode #find-replace-header button {
    pointer-events: auto;
}

body.compact-mode #custom-alert > div:last-child,
body.compact-mode #image-cap-dialog > div:last-child,
body.compact-mode #link-image-dialog > div:last-child,
body.compact-mode #theme-dialog > div:last-child {
    padding: 16px !important;
}

body.compact-mode #custom-alert button,
body.compact-mode #image-cap-dialog button,
body.compact-mode #link-image-dialog button,
body.compact-mode #theme-dialog-cancel,
body.compact-mode #theme-dialog-apply,
body.compact-mode #find-replace-bar button {
    padding: 6px 14px;
    font-size: 11px;
}

body.compact-mode #find-replace-bar input {
    padding: 6px 10px !important;
    font-size: 12px !important;
}

body.compact-mode #find-replace-bar label {
    font-size: 11px;
}

body.compact-mode #find-replace-bar #match-count {
    font-size: 10px;
}

/* Compact mode for flags dropdown */
body.compact-mode .flags-toggle {
    padding: 4px 8px !important;
    font-size: 11px !important;
    min-width: 70px !important;
}

body.compact-mode .flags-toggle .material-symbols-outlined {
    font-size: 12px !important;
}

body.compact-mode .flags-menu {
    min-width: 160px !important;
    font-size: 11px !important;
}

body.compact-mode .flag-option {
    padding: 6px 10px !important;
}

body.compact-mode .flag-option div > div:first-child {
    font-size: 11px !important;
}

body.compact-mode .flag-option div > div:last-child {
    font-size: 9px !important;
}

body.compact-mode .flag-checkbox {
    width: 14px !important;
    height: 14px !important;
    margin-right: 6px !important;
}

body.compact-mode #find-replace-bar input[type="checkbox"] {
    width: 14px !important;
    height: 14px !important;
    margin-right: 4px !important;
}

/* Compact mode dark mode for flags dropdown */
body.compact-mode.dark-mode .flags-toggle {
    background: linear-gradient(to bottom, #2d3136 0%, #23272a 100%) !important;
    border-color: rgba(79, 195, 247, 0.2) !important;
    color: #e0e0e0 !important;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3) !important;
}

body.compact-mode.dark-mode .flags-toggle:hover {
    background: linear-gradient(to bottom, #3a3f44 0%, #2d3136 100%) !important;
    border-color: rgba(79, 195, 247, 0.4) !important;
    box-shadow: 0 2px 6px rgba(79, 195, 247, 0.2) !important;
}

body.compact-mode.dark-mode .flags-toggle:active,
body.compact-mode.dark-mode .flags-toggle:focus {
    background: linear-gradient(to bottom, #2d3136 0%, #23272a 100%) !important;
    border-color: rgba(79, 195, 247, 0.5) !important;
    transform: translateY(0) !important;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3) !important;
}

body.compact-mode.dark-mode .flags-menu {
    background: #23272a !important;
    border-color: rgba(79, 195, 247, 0.15) !important;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.4) !important;
}

body.compact-mode.dark-mode .flag-option:hover {
    background: rgba(79, 195, 247, 0.08) !important;
}

body.compact-mode.dark-mode .flag-option:active {
    background: rgba(79, 195, 247, 0.12) !important;
}

body.compact-mode.dark-mode .flag-option div > div:first-child {
    color: #e0e0e0 !important;
}

body.compact-mode.dark-mode .flag-option div > div:last-child {
    color: #999 !important;
}

body.compact-mode.dark-mode .flag-checkbox {
    accent-color: #4fc3f7 !important;
}

body.compact-mode.dark-mode #find-replace-bar input[type="checkbox"] {
    accent-color: #4fc3f7 !important;
}

body.compact-mode .theme-option-card {
    padding: 8px !important;
    font-size: 12px;
}

body.compact-mode .theme-option-card input[type="radio"] {
    width: 16px !important;
    height: 16px !important;
}

/* Compact mode styling for compact mode button */
body.compact-mode #compact-mode-toggle {
    width: 16px !important;
    height: 16px !important;
}

body.compact-mode .compact-mode-label {
    padding: 6px !important;
    gap: 8px !important;
}

body.compact-mode .compact-mode-label .material-symbols-outlined {
    font-size: 14px !important;
    margin-right: 4px !important;
}

body.compact-mode .compact-mode-label div > div:first-child {
    font-size: 11px !important;
}

body.compact-mode .compact-mode-label div > div:last-child {
    font-size: 10px !important;
}

/* Compact mode for heading and date/time dropdowns */
body.compact-mode .dropdown-menu {
    min-width: 180px !important;
    max-height: 320px !important;
    border-radius: 4px !important;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1) !important;
    margin-top: 2px !important;
}

body.compact-mode .dropdown-item {
    padding: 6px 10px !important;
    margin: 1px 3px !important;
    border-radius: 3px !important;
}

body.compact-mode .heading-option {
    gap: 8px !important;
}

body.compact-mode .heading-option .material-symbols-outlined {
    font-size: 16px !important;
}

body.compact-mode .heading-text div:first-child {
    font-size: 12px !important;
}

body.compact-mode .heading-desc {
    font-size: 9px !important;
    margin-top: 1px !important;
}

/* Compact mode for date/time dropdown */
body.compact-mode #datetime-dropdown {
    min-width: 200px !important;
}

body.compact-mode #datetime-dropdown .dropdown-item > div {
    padding: 3px 0 !important;
}

body.compact-mode #datetime-dropdown .dropdown-item div[style*="font-weight:500"] {
    font-size: 11px !important;
}

body.compact-mode #datetime-dropdown .heading-desc {
    font-size: 10px !important;
}

/* Reduce gap between toolbar button and dropdown in compact mode */
body.compact-mode .dropdown {
    position: relative;
}

body.compact-mode .dropdown .dropdown-menu {
    top: calc(100% + 2px) !important;
}

/* Dark mode for compact mode toggle */
body.dark-mode .compact-mode-label {
    background: transparent !important;
}

body.dark-mode .compact-mode-label:hover {
    background: rgba(79, 195, 247, 0.08) !important;
}

body.dark-mode .compact-mode-label .material-symbols-outlined {
    color: #4fc3f7 !important;
}

body.dark-mode .compact-mode-label div > div:first-child {
    color: #e0e0e0 !important;
}

body.dark-mode .compact-mode-label div > div:last-child {
    color: #999 !important;
}

body.dark-mode #compact-mode-toggle {
    accent-color: #4fc3f7 !important;
}

/* Compact mode + dark mode combo */
body.compact-mode.dark-mode .compact-mode-label {
    background: transparent !important;
}

body.compact-mode.dark-mode .compact-mode-label:hover {
    background: rgba(79, 195, 247, 0.08) !important;
}

body.compact-mode.dark-mode .compact-mode-label .material-symbols-outlined {
    color: #4fc3f7 !important;
    font-size: 14px !important;
    margin-right: 4px !important;
}

body.compact-mode.dark-mode .compact-mode-label div > div:first-child {
    color: #e0e0e0 !important;
    font-size: 11px !important;
}

body.compact-mode.dark-mode .compact-mode-label div > div:last-child {
    color: #999 !important;
    font-size: 10px !important;
}

body.compact-mode.dark-mode #compact-mode-toggle {
    accent-color: #4fc3f7 !important;
    width: 16px !important;
    height: 16px !important;
}

body.compact-mode .theme-option-card .material-symbols-outlined {
    font-size: 20px !important;
}

body.compact-mode .theme-option-card > div > div:first-child {
    font-size: 13px;
}

body.compact-mode .theme-option-card > div > div:last-child {
    font-size: 11px;
}

/* Windows 11 Style Theme Cards */
.theme-preview-card {
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
}

.theme-preview-card:hover {
    border-color: #007acc !important;
    box-shadow: 0 4px 16px rgba(0, 122, 204, 0.2) !important;
    transform: translateY(-2px);
}

.theme-preview-card input[type="radio"]:checked ~ * .theme-check {
    opacity: 1 !important;
}

.theme-preview-card input[type="radio"]:checked + .theme-preview {
    border: 2px solid rgba(0, 122, 204, 0.3);
    box-shadow: inset 0 0 0 2px rgba(0, 122, 204, 0.1);
}

.theme-preview-card:has(input[type="radio"]:checked) {
    border-color: #007acc !important;
    box-shadow: 0 4px 16px rgba(0, 122, 204, 0.3) !important;
}

.theme-preview-card .theme-check {
    animation: checkPop 0.3s cubic-bezier(0.68, -0.55, 0.27, 1.55);
}

@keyframes checkPop {
    0% {
        transform: scale(0);
        opacity: 0;
    }
    50% {
        transform: scale(1.2);
    }
    100% {
        transform: scale(1);
        opacity: 1;
    }
}

/* Dark mode theme dialog */
.dark-mode #theme-dialog .theme-preview-card > div:last-child {
    background: #23272a !important;
}

.dark-mode #theme-dialog .theme-preview-card > div:last-child > div:first-child {
    color: #e0e0e0 !important;
}

.dark-mode #theme-dialog .theme-preview-card > div:last-child > div:last-child {
    color: #999 !important;
}

.dark-mode #theme-dialog h3,
.dark-mode #theme-dialog h4 {
    color: #e0e0e0 !important;
}

/* Auto theme badge in dark mode */
.dark-mode #theme-dialog .theme-preview-card[data-theme="auto"] .theme-preview > div:nth-child(2) {
    background: rgba(0, 0, 0, 0.7) !important;
    color: #4fc3f7 !important;
}

/* Compact mode transition */
body.compact-mode {
    transition: all 0.3s ease;
}

body.compact-mode * {
    transition: all 0.2s ease;
}

/* Modern Status Bar Design */
.status-bar {
    background: rgba(249, 249, 249, 0.9);
    backdrop-filter: blur(30px);
    -webkit-backdrop-filter: blur(30px);
    border-top: 1px solid rgba(0, 0, 0, 0.06);
    padding: 6px 16px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 12px;
    font-weight: 500;
    color: #6b7280;
    box-shadow: 0 -2px 4px rgba(0, 0, 0, 0.03);
    min-height: 28px;
    border-radius: 0;
}

#status-left {
    display: flex;
    align-items: center;
    gap: 12px;
    color: #0078d4;
    font-weight: 600;
}

#status-right {
    display: flex;
    align-items: center;
    gap: 16px;
}

#status-right span {
    padding: 0;
    background: transparent;
    backdrop-filter: none;
    -webkit-backdrop-filter: none;
    border-radius: 0;
    transition: none;
    border: none;
}

#status-right span:hover {
    background: transparent;
    transform: none;
    box-shadow: none;
}

/* Dark mode status bar */
.dark-mode .status-bar {
    background: rgba(42, 45, 49, 0.9);
    backdrop-filter: blur(30px);
    -webkit-backdrop-filter: blur(30px);
    border-top-color: rgba(255, 255, 255, 0.06);
    box-shadow: 0 -2px 4px rgba(0, 0, 0, 0.2);
    color: #9ca3af;
}

.dark-mode #status-left {
    color: #4fc3f7;
}

.dark-mode #status-right span {
    background: transparent !important;
    backdrop-filter: none !important;
    -webkit-backdrop-filter: none !important;
    border-color: transparent !important;
}

.dark-mode #status-right span:hover {
    background: transparent !important;
    box-shadow: none !important;
}

.font-select, .font-size {
    padding: 4px 8px;
    border: 1px solid #ccc;
    border-radius: 3px;
    font-size: 12px;
    background-color: white;
}

/* Modern Pane Header Design */
.pane-header {
    background: rgba(249, 249, 249, 0.9);
    backdrop-filter: blur(30px);
    -webkit-backdrop-filter: blur(30px);
    border-bottom: 1px solid rgba(0, 0, 0, 0.04);
    padding: 10px 16px;
    font-size: 13px;
    font-weight: 600;
    color: #1a1a1a;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.03);
    display: flex;
    align-items: center;
    gap: 8px;
    position: relative;
}

.pane-header::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    bottom: 0;
    width: 4px;
    background: #0078d4;
    border-radius: 0 2px 2px 0;
    opacity: 0;
    transform: scaleY(0.4);
    transition: opacity 0.2s ease, transform 0.2s ease;
}

.editor-pane.is-active .pane-header::before,
.preview-pane.is-active .pane-header::before {
    opacity: 1;
    transform: scaleY(1);
}

.editor-pane.is-active .pane-header,
.preview-pane.is-active .pane-header {
    color: #0078d4;
}

/* Dark mode pane header */
.dark-mode .pane-header {
    background: rgba(42, 45, 49, 0.9);
    backdrop-filter: blur(30px);
    -webkit-backdrop-filter: blur(30px);
    border-bottom-color: rgba(255, 255, 255, 0.06);
    color: #f5f5f5;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
}

.dark-mode .pane-header::before {
    background: #4fc3f7;
}

.dark-mode .editor-pane.is-active .pane-header,
.dark-mode .preview-pane.is-active .pane-header {
    color: #4fc3f7;
}

/* Modern Splitter Design */
.splitter {
    width: 6px;
    background: rgba(229, 231, 235, 0.8);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    cursor: col-resize;
    position: relative;
    transition: all 0.25s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    box-shadow: inset 0 0 0 1px rgba(0, 0, 0, 0.04);
}

.splitter::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 2px;
    height: 40px;
    background: rgba(0, 120, 212, 0.2);
    border-radius: 1px;
}

.splitter::after {
    content: '';
    position: absolute;
    top: calc(50% - 12px);
    left: 50%;
    transform: translateX(-50%);
    width: 2px;
    height: 4px;
    background: rgba(0, 120, 212, 0.4);
    border-radius: 1px;
    box-shadow: 
        0 8px 0 rgba(0, 120, 212, 0.4),
        0 16px 0 rgba(0, 120, 212, 0.4);
}

.splitter:hover {
    background: rgba(209, 213, 219, 0.9);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    width: 8px;
    box-shadow: inset 0 0 0 1px rgba(0, 0, 0, 0.06);
}

.splitter:hover::before {
    background: rgba(0, 120, 212, 0.4);
    height: 60px;
}

.splitter:active {
    background: rgba(0, 120, 212, 0.9);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
}

.splitter:active::before {
    background: rgba(255, 255, 255, 0.8);
}

.splitter:active::after {
    background: rgba(255, 255, 255, 0.8);
    box-shadow: 
        0 8px 0 rgba(255, 255, 255, 0.8),
        0 16px 0 rgba(255, 255, 255, 0.8);
}

/* Dark mode splitter */
.dark-mode .splitter {
    background: rgba(60, 64, 67, 0.8);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.04);
}

.dark-mode .splitter::before {
    background: rgba(79, 195, 247, 0.3);
}

.dark-mode .splitter::after {
    background: rgba(79, 195, 247, 0.5);
    box-shadow: 
        0 8px 0 rgba(79, 195, 247, 0.5),
        0 16px 0 rgba(79, 195, 247, 0.5);
}

.dark-mode .splitter:hover {
    background: rgba(70, 74, 77, 0.9);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.06);
}

.dark-mode .splitter:hover::before {
    background: rgba(79, 195, 247, 0.6);
}

.dark-mode .splitter:active {
    background: rgba(79, 195, 247, 0.9);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
}

.main-container {
    flex: 1;
    display: flex;
    overflow: hidden;
    position: relative;
}

.editor-pane, .preview-pane {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    position: relative;
}

.editor-pane::after, .preview-pane::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 1px;
    background: linear-gradient(90deg, transparent, rgba(0, 122, 204, 0.2), transparent);
    pointer-events: none;
}

/* Modern Editor Textarea */
.editor-textarea {
    font-family: monospace;
    line-height: 1.6;
    padding: 20px;
    border: none;
    outline: none;
    resize: none;
    box-shadow: inset 0 0 0 1px rgba(0, 0, 0, 0.03);
}

.editor-textarea:focus {
    box-shadow: inset 0 0 0 2px rgba(0, 120, 212, 0.15);
}

/* Modern Preview Content */
.preview-content {
    font-family: sans-serif;
    padding: 20px;
    overflow-y: auto;
    box-shadow: inset 0 0 0 1px rgba(0, 0, 0, 0.03);
}

.preview-content:focus {
    box-shadow: inset 0 0 0 2px rgba(0, 0, 0, 0.08);
}

/* Modern Scrollbar */
::-webkit-scrollbar {
    width: 12px;
    height: 12px;
}

::-webkit-scrollbar-track {
    background: transparent;
}

::-webkit-scrollbar-thumb {
    background: rgba(0, 0, 0, 0.2);
    border-radius: 6px;
    border: 3px solid transparent;
    background-clip: padding-box;
    transition: background 0.25s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

::-webkit-scrollbar-thumb:hover {
    background: rgba(0, 0, 0, 0.35);
    background-clip: padding-box;
}

::-webkit-scrollbar-thumb:active {
    background: rgba(0, 120, 212, 0.7);
    background-clip: padding-box;
}

::-webkit-scrollbar-corner {
    background: transparent;
}

.editor-textarea {
    flex: 1;
    background-color: white;
}

/* Word-wrap class for editor textarea. When applied, the editor will soft-wrap long lines. */
.editor-textarea.wrap {
    white-space: pre-wrap; /* keep existing newlines, wrap long lines */
    overflow-wrap: break-word;
    word-wrap: break-word;
    word-break: break-word;
}

.preview-content {
    flex: 1;
    padding: 20px;
    background-color: white;
    overflow-y: auto;
    border-left: 1px solid #ddd;
    outline: none;
    min-height: 200px;
}

.preview-content:focus {
    outline: 2px solid rgba(0, 0, 0, 0.12);
    outline-offset: -2px;
}

.preview-content[contenteditable="true"] {
    cursor: text;
}

.preview-content[contenteditable="true"]:hover {
    background-color: #fafafa;
}

.preview-content h1, .preview-content h2, .preview-content h3,
.preview-content h4, .preview-content h5, .preview-content h6 {
    margin-top: 20px;
    margin-bottom: 10px;
    line-height: 1.2;
}

.preview-content h1 { font-size: 2em; border-bottom: 2px solid rgba(0, 0, 0, 0.06); padding-bottom: 10px; }
.preview-content h2 { font-size: 1.5em; border-bottom: 1px solid rgba(0, 0, 0, 0.06); padding-bottom: 8px; }
.preview-content h3 { font-size: 1.3em; }
.preview-content h4 { font-size: 1.1em; }
.preview-content h5 { font-size: 1em; }
.preview-content h6 { font-size: 0.9em; }

.preview-content p {
    margin-bottom: 15px;
    line-height: 1.6;
}

.preview-content ul, .preview-content ol {
    margin-bottom: 15px;
    padding-left: 30px;
}

.preview-content li {
    margin-bottom: 5px;
}

.preview-content code {
    background-color: #f0f0f0;
    padding: 2px 4px;
    border-radius: 3px;
    font-family: 'Courier New', monospace;
    -webkit-text-fill-color: initial;
    color: #222;
}

.preview-content a {
    color: #005a9e;
    text-decoration: underline;
}
.preview-content a:hover {
    color: #003f6e;
}

.preview-content img {
    max-width: 100%;
    height: auto;
}

/* Image positioning/wrapping styles */
.preview-content img.img-left {
    float: left;
    margin: 0 20px 15px 0;
    max-width: 50%;
}

.preview-content img.img-right {
    float: right;
    margin: 0 0 15px 20px;
    max-width: 50%;
}

.preview-content img.img-center {
    display: block;
    margin-left: auto;
    margin-right: auto;
}

/* Clear floats after images */
.preview-content .img-clear {
    clear: both;
}

/* Auto-resize class for inserted images from link (controlled by dialog) */
:root { --md-auto-resize-max: 800px; }
.preview-content img.md-auto-resize {
    display: block;
    height: auto;
    margin-left: auto;
    margin-right: auto;
    object-fit: contain;
    max-width: var(--md-auto-resize-max); /* configurable cap */
    width: 100%; /* scale to container by default; inline styles (inserted) will override when present */
}

/* Modern changelog styling */
/* TL;DR card shown above changelog versions */
.tldr-card {
    background: linear-gradient(180deg, #eef7ff 0%, #f7fbff 100%);
    border: 1px solid #cfe5ff;
    border-radius: 10px;
    padding: 16px 18px;
    margin: 0 0 16px 0;
}
.tldr-title {
    font-weight: 700;
    color: #007acc;
    letter-spacing: 0.4px;
    margin-bottom: 8px;
}
.tldr-list {
    margin: 0;
    padding-left: 18px;
    color: #334155;
}
.tldr-list li { margin: 6px 0; }

/* Dark mode TL;DR */
.dark-mode .tldr-card {
    background: linear-gradient(180deg, #1f2937 0%, #0f172a 100%);
    border-color: #3b3f46;
}
.dark-mode .tldr-title { color: #4fc3f7; }
.dark-mode .tldr-list { color: #e0e0e0; }
.changelog-versions {
    display: flex;
    flex-direction: column;
    gap: 20px;
}

.version-item {
    background: #f8f9fa;
    border: 1px solid #e9ecef;
    border-radius: 8px;
    padding: 20px;
    transition: all 0.3s ease;
    position: relative;
}

.version-item:hover {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    transform: translateY(-2px);
}

.version-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
    padding-bottom: 10px;
    border-bottom: 1px solid #dee2e6;
}

.version-number {
    font-size: 1.3em;
    font-weight: bold;
    color: #007acc;
    background: linear-gradient(135deg, #007acc, #0056b3);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.version-date {
    font-size: 0.9em;
    color: #6c757d;
    font-weight: 500;
}

.version-content {
    color: #495057;
    line-height: 1.6;
}

.version-content p {
    margin-bottom: 10px;
    font-size: 0.95em;
}

.version-content ul {
    margin: 10px 0;
    padding-left: 20px;
}

.version-content li {
    margin-bottom: 8px;
    position: relative;
}

.version-content li::marker {
    color: #007acc;
}

/* Dark mode for changelog */
.dark-mode .changelog-header {
    border-bottom-color: #444;
}

.dark-mode .changelog-header h1 {
    color: #4fc3f7;
}

.dark-mode .changelog-description {
    color: #ccc;
}

.dark-mode .changelog-credits {
    color: #aaa;
}

.dark-mode .changelog-contact {
    color: #999;
}

.dark-mode .version-item {
    background: #2b2b2b;
    border-color: #444;
}

.dark-mode .version-item:hover {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

.dark-mode .version-header {
    border-bottom-color: #444;
}

.dark-mode .version-number {
    color: #4fc3f7;
}

.dark-mode .version-date {
    color: #aaa;
}

.dark-mode .version-content {
    color: #e0e0e0;
}

.dark-mode .version-content li::marker {
    color: #4fc3f7;
}

/* OG Version special styling */
.version-item.og-version {
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    border: 2px solid #007acc;
    position: relative;
    overflow: hidden;
}

.version-item.og-version::before {
    content: "";
    position: absolute;
    top: 10px;
    right: 10px;
    font-size: 1.5em;
    opacity: 0.7;
}

.version-item.og-version .version-number {
    background: linear-gradient(135deg, #007acc, #0056b3, #003d82);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    font-size: 1.5em;
    font-weight: 900;
}

.version-item.og-version .version-date {
    color: #007acc;
    font-weight: bold;
    font-size: 1em;
}

.dark-mode .version-item.og-version {
    background: linear-gradient(135deg, #2b2b2b 0%, #23272a 100%);
    border-color: #4fc3f7;
}

.dark-mode .version-item.og-version .version-number {
    color: #4fc3f7;
}

.dark-mode .version-item.og-version .version-date {
    color: #4fc3f7;
}

.dark-mode .preview-content code {
    color: #e0e0e0;
    -webkit-text-fill-color: initial;
}

.dark-mode .preview-content a { color: #4fc3f7; }
.dark-mode .preview-content a:hover { color: #22d3ee; }

/* Dropdown styling */
.dropdown {
    position: relative;
    display: inline-block;
    overflow: visible;
}

.dropdown-arrow {
    font-size: 10px;
    margin-left: 4px;
}

.dropdown-menu {
    position: fixed;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(30px);
    -webkit-backdrop-filter: blur(30px);
    border: 1px solid rgba(0, 0, 0, 0.08);
    border-radius: 6px;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12), 0 0 0 1px rgba(255, 255, 255, 0.5) inset;
    min-width: 200px;
    z-index: 99999;
    overflow: visible;
    animation: dropdownFadeIn 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    max-height: 400px;
    overflow-y: auto;
}

.dropdown-item {
    padding: 10px 14px;
    cursor: pointer;
    transition: all 0.15s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    border-radius: 4px;
    margin: 2px 4px;
}

.heading-option {
    display: flex;
    align-items: center;
    gap: 12px;
}

.heading-option .material-symbols-outlined {
    color: #0078d4;
    font-size: 20px;
    flex-shrink: 0;
}

.heading-text {
    flex: 1;
}

.heading-desc {
    font-size: 11px;
    color: #666;
    margin-top: 2px;
}

.dropdown-item:hover {
    background: rgba(0, 120, 212, 0.08);
    transform: translateX(2px);
}

/* Dark mode dropdown */
body.dark-mode .dropdown-menu {
    background: rgba(42, 45, 49, 0.95);
    backdrop-filter: blur(30px);
    -webkit-backdrop-filter: blur(30px);
    border-color: rgba(255, 255, 255, 0.08);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.4), 0 0 0 1px rgba(255, 255, 255, 0.05) inset;
}

body.dark-mode .dropdown-item {
    color: #e0e0e0;
}

body.dark-mode .dropdown-item:hover {
    background: rgba(79, 195, 247, 0.12);
    transform: translateX(2px);
}

.datetime-option {
    display: flex;
    flex-direction: column;
    padding: 2px 0;
}

.datetime-option-title {
    font-weight: 500;
    font-size: 12px;
    color: #202124;
}

.datetime-option-preview {
    font-size: 10px;
    color: #5f6368;
}

.dark-mode .datetime-option-title {
    color: #f1f3f4;
}

.dark-mode .datetime-option-preview {
    color: #b0b8c3;
}

/* Disabled dropdown items */
.dropdown-item.disabled {
    color: #999;
    cursor: not-allowed;
    opacity: 0.6;
}

.dropdown-item.disabled:hover {
    background-color: transparent;
}

body.dark-mode .dropdown-item.disabled {
    color: #666;
}

/* Dropdown animation */
@keyframes dropdownFadeIn {
    from {
        opacity: 0;
        transform: translateY(-8px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Status Bar Formatting Selector */
#formatting-selector {
    cursor: pointer;
    padding: 4px 8px;
    border-radius: 10px;
    transition: all 0.25s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

#formatting-selector:hover {
    background: rgba(0, 120, 212, 0.06);
    transform: scale(1.03);
    box-shadow: 0 1px 2px rgba(0, 120, 212, 0.1);
}

.formatting-menu {
    position: absolute;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(30px);
    -webkit-backdrop-filter: blur(30px);
    border: 1px solid rgba(0, 0, 0, 0.08);
    border-radius: 6px;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12), 0 0 0 1px rgba(255, 255, 255, 0.5) inset;
    min-width: 120px;
    z-index: 99999;
    overflow: visible;
    animation: dropdownFadeIn 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.formatting-option {
    padding: 8px 12px;
    cursor: pointer;
    transition: all 0.15s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    border-radius: 4px;
    margin: 2px 4px;
    font-size: 12px;
}

.formatting-option:hover {
    background: rgba(0, 120, 212, 0.08);
    transform: translateX(2px);
}

/* Dark mode formatting menu */
body.dark-mode .formatting-menu {
    background: rgba(42, 45, 49, 0.95);
    backdrop-filter: blur(30px);
    -webkit-backdrop-filter: blur(30px);
    border-color: rgba(255, 255, 255, 0.08);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.4), 0 0 0 1px rgba(255, 255, 255, 0.05) inset;
}

body.dark-mode .formatting-option {
    color: #e0e0e0;
}

body.dark-mode .formatting-option:hover {
    background: rgba(79, 195, 247, 0.12);
    transform: translateX(2px);
}

/* Tabs toggle styling */
#tabs-toggle {
    padding: 4px 8px;
    border-radius: 10px;
    transition: all 0.25s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

#tabs-toggle:hover {
    background: rgba(0, 120, 212, 0.06);
    transform: scale(1.03);
    box-shadow: 0 1px 2px rgba(0, 120, 212, 0.1);
}

#tabs-toggle:active {
    transform: scale(0.98);
}

/* Dark mode tabs toggle */
body.dark-mode #tabs-toggle:hover {
    background: rgba(79, 195, 247, 0.08);
    box-shadow: 0 1px 2px rgba(79, 195, 247, 0.2);
}

/* Theme option styling */
.theme-option {
    display: flex;
    align-items: center;
    gap: 8px;
}

.theme-option .beta-badge {
    font-size: 10px;
    background: #0078d4;
    color: #fff;
    padding: 2px 6px;
    border-radius: 3px;
    font-weight: normal;
    margin-left: 4px;
}

body.dark-mode .theme-option .beta-badge {
    background: #005a9e;
}

/* Theme dialog styling */
.theme-option-card:hover {
    border-color: #007acc !important;
    background-color: #f0f8ff;
}

.theme-option-card input[type="radio"]:checked {
    accent-color: #007acc;
}

.theme-option-card:has(input[type="radio"]:checked) {
    border-color: #007acc !important;
    background-color: #e6f3ff;
}

/* Dark mode for theme dialog */
body.dark-mode #theme-dialog {
    background: #181a1b !important;
    border-color: #444 !important;
}

body.dark-mode #theme-dialog h3,
body.dark-mode #theme-dialog h4 {
    color: #e0e0e0 !important;
}

body.dark-mode .theme-option-card {
    border-color: #444 !important;
    background: #23272a;
}

body.dark-mode .theme-option-card:hover {
    border-color: #007acc !important;
    background-color: #2d3136;
}

body.dark-mode .theme-option-card:has(input[type="radio"]:checked) {
    border-color: #007acc !important;
    background-color: #1a3a52;
}

body.dark-mode .theme-option-card div {
    color: #e0e0e0;
}

body.dark-mode #theme-dialog-cancel {
    background: #23272a !important;
    color: #e0e0e0 !important;
    border-color: #444 !important;
}

body.dark-mode #theme-dialog-cancel:hover {
    background: #2d3136 !important;
}

.preview-content pre {
    background-color: #f8f8f8;
    border: 1px solid #ddd;
    border-radius: 3px;
    padding: 15px;
    overflow-x: auto;
    margin-bottom: 15px;
    white-space: pre;
    word-wrap: normal;
}

/* Ensure code blocks remain scrollable even when word wrap is enabled globally */
.preview-content pre code {
    white-space: pre;
    word-wrap: normal;
    overflow-wrap: normal;
    display: block;
    background-color: transparent;
    padding: 0;
}

.preview-content hr {
    border: none;
    border-top: 1px solid #ddd;
    margin: 16px 0;
}

.preview-content blockquote {
    border-left: 4px solid #007acc;
    background: #eaf6fb;
    padding: 10px 20px;
    margin: 15px 0;
    color: #005a9e;
    font-family: inherit;
}

.preview-content blockquote blockquote {
    border-left-color: #7dd3fc;
    background: #f0f9ff;
    margin-top: 10px;
    margin-bottom: 10px;
}

.preview-content table {
    border-collapse: collapse;
    width: 100%;
    margin-bottom: 15px;
}

.preview-content th, .preview-content td {
    border: 1px solid #ddd;
    padding: 8px;
    text-align: left;
}

.preview-content th {
    background-color: #f0f0f0;
    font-weight: bold;
}

.preview-content table.table-borderless {
    border: none;
}

.preview-content table.table-borderless th,
.preview-content table.table-borderless td {
    border: none;
}

.preview-content table.table-striped tbody tr:nth-child(even) {
    background-color: #f8fafc;
}

.preview-content table.table-header-highlight thead th {
    background: linear-gradient(180deg, #e8f1fb 0%, #d4e6fb 100%);
    color: #0b4a86;
}

.hidden-file-input {
    display: none;
}

/* Table alignment helpers */
.preview-content th.align-left, .preview-content td.align-left { text-align: left; }
.preview-content th.align-center, .preview-content td.align-center { text-align: center; }
.preview-content th.align-right, .preview-content td.align-right { text-align: right; }

/* Task lists */
.preview-content ul.task-list { list-style: none; padding-left: 0; }
.preview-content li.task-item { list-style: none; margin-left: 0; }
/* Custom checkbox styling (disabled but themed) */
.preview-content li.task-item input[type="checkbox"] {
    width: 16px;
    height: 16px;
    margin-right: 6px;
    cursor: pointer;
    accent-color: #007acc;
    vertical-align: middle;
}

/* Footnotes */
.preview-content .footnotes { font-size: 0.9em; color: #555; }
.preview-content .footnotes hr { border: none; border-top: 1px solid #ddd; margin: 20px 0; }
.preview-content .footnotes ol { padding-left: 24px; }
.preview-content .footnote-ref a { text-decoration: none; }
.preview-content .footnote-backref { text-decoration: none; margin-left: 6px; }

/* Definition lists */
.preview-content dl { margin: 12px 0; }
.preview-content dt { font-weight: 600; }
.preview-content dd { margin: 0 0 10px 20px; }

/* Sub/Sup baseline tweaks */
.preview-content sub, .preview-content sup { line-height: 0; }

/* Consistent close button styling */
.close-btn {
    background: none;
    border: none;
    color: #666;
    font-size: 18px;
    cursor: pointer;
    padding: 4px 8px;
    border-radius: 3px;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    min-width: 24px;
    min-height: 24px;
}

.close-btn:hover {
    background-color: #f0f0f0;
    color: #333;
}

.close-btn:active {
    background-color: #e0e0e0;
}

/* Dark mode for close buttons */
.dark-mode .close-btn {
    color: #ccc;
}

.dark-mode .close-btn:hover {
    background-color: #333;
    color: #fff;
}

.dark-mode .close-btn:active {
    background-color: #444;
}

/* Close button in popup headers */
.popup-header .close-btn {
    color: #fff;
    font-size: 20px;
    padding: 2px 6px;
}

.popup-header .close-btn:hover {
    background-color: rgba(255, 255, 255, 0.2);
    color: #fff;
}

.popup-header .close-btn:active {
    background-color: rgba(255, 255, 255, 0.3);
}

/* Link and Image dialog close buttons - icon only, no box unless hovered/clicked */
#dialog-title-close,
#image-cap-close {
    background: transparent !important;
    border: none !important;
    padding: 8px !important;
    box-shadow: none !important;
    min-width: 36px !important;
    min-height: 36px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    color: #fff !important;
    font-size: 20px !important;
    cursor: pointer !important;
    border-radius: 4px !important;
    transition: all 0.2s ease !important;
}

#dialog-title-close:hover,
#image-cap-close:hover {
    background: rgba(255, 255, 255, 0.2) !important;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15), 0 0 0 1px rgba(255, 255, 255, 0.3) inset !important;
    transform: translateY(-1px);
}

#dialog-title-close:active,
#image-cap-close:active {
    transform: translateY(0) !important;
    box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.2) inset !important;
    background: rgba(255, 255, 255, 0.3) !important;
}

/* Dark mode for Link and Image dialog close buttons */
.dark-mode #dialog-title-close,
.dark-mode #image-cap-close {
    background: transparent !important;
    border: none !important;
    box-shadow: none !important;
    color: #fff !important;
}

.dark-mode #dialog-title-close:hover,
.dark-mode #image-cap-close:hover {
    background: rgba(255, 255, 255, 0.15) !important;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2), 0 0 0 1px rgba(255, 255, 255, 0.1) inset !important;
}

.dark-mode #dialog-title-close:active,
.dark-mode #image-cap-close:active {
    background: rgba(255, 255, 255, 0.25) !important;
    box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.15) inset !important;
}

/* Find/Replace bar close button - icon only, no box unless hovered/clicked */
#find-close {
    background: transparent !important;
    border: none !important;
    padding: 8px !important;
    box-shadow: none !important;
    min-width: 36px !important;
    min-height: 36px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    color: #fff !important;
    font-size: 20px !important;
    cursor: pointer !important;
    border-radius: 4px !important;
    transition: all 0.2s ease !important;
}

#find-close:hover {
    background: rgba(255, 255, 255, 0.2) !important;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15), 0 0 0 1px rgba(255, 255, 255, 0.3) inset !important;
    transform: translateY(-1px);
}

#find-close:active {
    transform: translateY(0) !important;
    box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.2) inset !important;
    background: rgba(255, 255, 255, 0.3) !important;
}

/* Dark mode for find/replace close button */
.dark-mode #find-close {
    background: transparent !important;
    border: none !important;
    box-shadow: none !important;
    color: #fff !important;
}

.dark-mode #find-close:hover {
    background: rgba(255, 255, 255, 0.15) !important;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2), 0 0 0 1px rgba(255, 255, 255, 0.1) inset !important;
}

.dark-mode #find-close:active {
    background: rgba(255, 255, 255, 0.25) !important;
    box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.15) inset !important;
}

/* Search history dropdown styling */
.search-history-select {
    border-radius: 3px;
    transition: all 0.2s ease;
}

.search-history-select:focus {
    outline: 2px solid #007acc;
    outline-offset: 1px;
}

.dark-mode .search-history-select:focus {
    outline-color: #4fc3f7;
}

/* Default Search History Dropdown */
.search-history-dropdown {
    min-width: 200px;
}

/* Undo/Redo History Dropdown */
.undo-history-dropdown {
    background: #ffffff;
    border: 1px solid #ccc;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
    font-size: 13px;
    min-width: 220px;
    max-height: 320px;
    overflow-y: auto;
    cursor: pointer;
    padding: 4px 0;
    color: #222;
    border-radius: 6px;
}

.undo-history-item {
    padding: 4px 12px;
    border-bottom: 1px solid #eee;
    transition: background 0.15s ease;
}

.undo-history-item:hover {
    background: #f0f0f0;
}

.undo-history-item:last-child {
    border-bottom: none;
}

/* Dark mode for undo/redo history */
.dark-mode .undo-history-dropdown {
    background: #23272a;
    border-color: #444;
    color: #e0e0e0;
}

.dark-mode .undo-history-item {
    border-bottom-color: #444;
}

.dark-mode .undo-history-item:hover {
    background: #2d3136;
}

/* Underwater theme for undo/redo history */
body.theme-underwater .undo-history-dropdown {
    background: #002b54 !important;
    border-color: #0077be !important;
    color: #00d4ff !important;
}

body.theme-underwater .undo-history-item {
    border-bottom-color: #0077be !important;
}

body.theme-underwater .undo-history-item:hover {
    background: #003d6b !important;
}

/* Sand theme for undo/redo history */
body.theme-sand .undo-history-dropdown {
    background: #fff9eb !important;
    border-color: #d4a574 !important;
    color: #2c1810 !important;
}

body.theme-sand .undo-history-item {
    border-bottom-color: #e8d4b0 !important;
}

body.theme-sand .undo-history-item:hover {
    background: #f4ead4 !important;
}

/* Night Sky theme for undo/redo history */
body.theme-night-sky .undo-history-dropdown {
    background: #1a1a2e !important;
    border-color: #6c5ce7 !important;
    color: #b8a3ff !important;
}

body.theme-night-sky .undo-history-item {
    border-bottom-color: #6c5ce7 !important;
}

body.theme-night-sky .undo-history-item:hover {
    background: #16213e !important;
}

/* Forest Green theme for undo/redo history */
body.theme-forest-green .undo-history-dropdown {
    background: #243824 !important;
    border-color: #4a7c4a !important;
    color: #90ee90 !important;
}

body.theme-forest-green .undo-history-item {
    border-bottom-color: #4a7c4a !important;
}

body.theme-forest-green .undo-history-item:hover {
    background: #2d5016 !important;
}

/* WCAG Focus Indicators - Enhanced keyboard navigation visibility */
body.theme-underwater *:focus-visible {
    outline: 2px solid #00d4ff !important;
    outline-offset: 2px;
}

body.theme-sand *:focus-visible {
    outline: 2px solid #9a7b4f !important;
    outline-offset: 2px;
}

body.theme-night-sky *:focus-visible {
    outline: 2px solid #b8a3ff !important;
    outline-offset: 2px;
}

body.theme-forest-green *:focus-visible {
    outline: 2px solid #90ee90 !important;
    outline-offset: 2px;
}

/* Enhanced button focus for all themes */
body.theme-underwater .toolbar-btn:focus-visible,
body.theme-sand .toolbar-btn:focus-visible,
body.theme-night-sky .toolbar-btn:focus-visible,
body.theme-forest-green .toolbar-btn:focus-visible {
    box-shadow: 0 0 0 3px currentColor !important;
    outline: none;
}

.search-history-toggle {
    display: flex;
    align-items: center;
    gap: 6px;
    background: #fff;
    border: 1px solid #ccc;
    border-radius: 4px;
    padding: 6px 12px;
    font-size: 12px;
    color: #333;
    cursor: pointer;
    transition: all 0.2s;
    min-width: 100%;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.06);
}

.search-history-toggle:hover {
    background: #f8f9fa;
    border-color: #999;
}

.search-history-toggle:active {
    background: #e9ecef;
    transform: translateY(0);
}

.search-history-toggle[aria-expanded="true"] {
    background: #e9ecef;
    border-color: #007acc;
}

.search-history-icon {
    font-size: 16px;
    color: #666;
}

.search-history-text {
    flex: 1;
    text-align: left;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.search-history-arrow {
    font-size: 16px;
    color: #666;
    transition: transform 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.search-history-toggle[aria-expanded="true"] .search-history-arrow {
    transform: rotate(180deg);
}

/* Search History Menu */
.search-history-menu {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    margin-top: 4px;
    background: #fff;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    z-index: 1000;
    overflow: hidden;
    animation: dropdownFadeIn 0.2s;
}

@keyframes dropdownFadeIn {
    from {
        opacity: 0;
        transform: translateY(-8px) scale(0.98);
    }
    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

.search-history-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 12px;
    background: rgba(0, 120, 212, 0.08);
    border-bottom: 1px solid rgba(0, 0, 0, 0.06);
}

.search-history-title {
    font-size: 11px;
    font-weight: 600;
    color: #333;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.clear-history-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    background: none;
    border: none;
    border-radius: 4px;
    padding: 4px;
    cursor: pointer;
    color: #666;
    transition: all 0.2s ease;
}

.clear-history-btn:hover {
    background: rgba(0, 0, 0, 0.08);
    color: #333;
}

.clear-history-btn .material-symbols-outlined {
    font-size: 16px;
}

.search-history-list {
    max-height: 200px;
    overflow-y: auto;
    padding: 4px;
}

.search-history-item {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 12px;
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.15s ease;
    font-size: 12px;
    color: #333;
    border: 1px solid transparent;
    outline: none;
}

.search-history-item:hover {
    background: rgba(0, 120, 212, 0.08);
    border-color: rgba(0, 120, 212, 0.2);
}

.search-history-item:active,
.search-history-item:focus {
    background: rgba(0, 120, 212, 0.12);
    border-color: rgba(0, 120, 212, 0.3);
    box-shadow: 0 0 0 2px rgba(0, 120, 212, 0.1);
}

.search-history-item .material-symbols-outlined {
    font-size: 16px;
    color: #666;
}

.search-history-item-text {
    flex: 1;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.search-history-item-remove {
    display: flex;
    align-items: center;
    justify-content: center;
    background: none;
    border: none;
    border-radius: 3px;
    padding: 2px;
    cursor: pointer;
    color: #666;
    opacity: 0;
    transition: all 0.15s ease;
}

.search-history-item:hover .search-history-item-remove {
    opacity: 1;
}

.search-history-item-remove:hover {
    background: rgba(255, 0, 0, 0.1);
    color: #d32f2f;
}

.search-history-item-remove .material-symbols-outlined {
    font-size: 14px;
}

/* Empty state */
.search-history-empty {
    padding: 16px 12px;
    text-align: center;
    font-size: 12px;
    color: #666;
    font-style: italic;
}

/* Dark mode styles */
.dark-mode .search-history-toggle {
    background: rgba(60, 64, 67, 0.8);
    border-color: rgba(255, 255, 255, 0.1);
    color: #e0e0e0;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3), 0 0 0 1px rgba(255, 255, 255, 0.05) inset;
}

.dark-mode .search-history-toggle:hover {
    background: rgba(70, 74, 77, 0.95);
    border-color: rgba(79, 195, 247, 0.3);
    box-shadow: 0 2px 4px rgba(79, 195, 247, 0.15), 0 0 0 1px rgba(255, 255, 255, 0.08) inset;
}

.dark-mode .search-history-toggle[aria-expanded="true"] {
    background: rgba(79, 195, 247, 0.15);
    border-color: rgba(79, 195, 247, 0.4);
    box-shadow: 0 0 0 2px rgba(79, 195, 247, 0.15), 0 1px 2px rgba(0, 0, 0, 0.2) inset;
}

.dark-mode .search-history-icon,
.dark-mode .search-history-arrow {
    color: #ccc;
}

.dark-mode .search-history-menu {
    background: rgba(42, 45, 49, 0.95);
    border-color: rgba(255, 255, 255, 0.06);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(255, 255, 255, 0.05) inset;
}

.dark-mode .search-history-header {
    background: rgba(79, 195, 247, 0.15);
    border-bottom-color: rgba(255, 255, 255, 0.06);
}

.dark-mode .search-history-title {
    color: #e0e0e0;
}

.dark-mode .clear-history-btn {
    color: #ccc;
}

.dark-mode .clear-history-btn:hover {
    background: rgba(255, 255, 255, 0.1);
    color: #fff;
}

.dark-mode .search-history-item {
    color: #e0e0e0;
}

.dark-mode .search-history-item:hover {
    background: rgba(79, 195, 247, 0.15);
    border-color: rgba(79, 195, 247, 0.3);
}

.dark-mode .search-history-item:active {
    background: rgba(79, 195, 247, 0.2);
}

.dark-mode .search-history-item .material-symbols-outlined {
    color: #ccc;
}

.dark-mode .search-history-item-remove {
    color: #ccc;
}

.dark-mode .search-history-item-remove:hover {
    background: rgba(255, 59, 48, 0.2);
    color: #ff453a;
}

.dark-mode .search-history-empty {
    color: #ccc;
}

/* Compact mode adjustments */
body.compact-mode .search-history-dropdown {
    min-width: 160px;
}

body.compact-mode .search-history-toggle {
    padding: 4px 8px;
    font-size: 11px;
}

body.compact-mode .search-history-icon,
body.compact-mode .search-history-arrow {
    font-size: 14px;
}

body.compact-mode .search-history-header {
    padding: 6px 8px;
}

body.compact-mode .search-history-title {
    font-size: 10px;
}

body.compact-mode .search-history-item {
    padding: 6px 8px;
    font-size: 11px;
}

body.compact-mode .search-history-list {
    max-height: 160px;
}

.view-toggle {
    display: flex;
    gap: 2px;
}

.view-toggle button {
    background-color: #f8f8f8;
    border: 1px solid #ccc;
    padding: 4px 8px;
    cursor: pointer;
    font-size: 11px;
}

.view-toggle button.active {
    background-color: #007acc;
    color: white;
}

.single-pane .editor-pane,
.single-pane .preview-pane {
    flex: 1;
}

.single-pane .splitter {
    display: none;
}

.editor-only .preview-pane,
.preview-only .editor-pane {
    display: none;
}

/* Context Menu Styles - Modern Light Mode */
#context-menu,
#context-menu-extended {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    user-select: none;
    -webkit-user-select: none;
    background: #ffffff;
    border: 1px solid rgba(0, 0, 0, 0.1);
    border-radius: 8px;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
    padding: 4px;
}

.context-menu-item {
    display: flex;
    align-items: center;
    padding: 8px 12px;
    cursor: pointer;
    border-radius: 6px;
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    color: #333;
    font-size: 13px;
}

.context-menu-item:hover {
    background-color: #f0f7ff;
    color: #007acc;
}

.context-menu-item:active {
    background-color: #e6f3ff;
    transform: scale(0.98);
}

.context-menu-item > span:nth-child(2) {
    flex: 1;
}

.context-menu-shortcut {
    font-size: 11px;
    color: #999;
    margin-left: auto;
}

.context-menu-separator {
    height: 1px; 
    background: linear-gradient(to right, transparent, rgba(0, 122, 204, 0.2), transparent);
    margin: 6px 0;
}

.context-menu-item:hover .context-menu-shortcut {
    color: #0088dd;
}

/* Dark mode for context menu */
.dark-mode #context-menu,
.dark-mode #context-menu-extended {
    background: #23272a !important;
    border: 1px solid rgba(79, 195, 247, 0.2) !important;
    border-radius: 8px !important;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.5) !important;
    padding: 4px !important;
}

.dark-mode .context-menu-item {
    color: #e0e0e0 !important;
}

.dark-mode .context-menu-item:hover {
    background-color: #2d3136 !important;
    color: #4fc3f7 !important;
}

.dark-mode .context-menu-item:active {
    background-color: #1a1d1f !important;
}

.dark-mode .context-menu-separator {
    background-color: rgba(79, 195, 247, 0.2) !important;
}

.dark-mode .context-menu-shortcut {
    color: #999 !important;
}

.dark-mode .context-menu-item:hover .context-menu-shortcut {
    color: #b0e7ff !important;
}

.context-menu-item[data-action="showMore"]:hover {
    background-color: #007acc;
    color: #fff;
}

.dark-mode .context-menu-item[data-action="showMore"]:hover {
    background-color: #0077be !important;
    color: #fff !important;
}

.dark-mode .context-menu-item[data-action="showMore"]:hover .context-menu-shortcut {
    color: #fff !important;
}

.context-menu-item[data-action="backToEditor"]:hover {
    background-color: #007acc;
    color: #fff;
}

.dark-mode .context-menu-item[data-action="backToEditor"]:hover {
    background-color: #0077be !important;
    color: #fff !important;
}

.dark-mode .context-menu-item[data-action="backToEditor"]:hover .context-menu-shortcut {
    color: #fff !important;
}

/* Underwater theme context menu */
body.theme-underwater #context-menu,
body.theme-underwater #context-menu-extended {
    background: #002b54 !important;
    border-color: #0077be !important;
    box-shadow: 0 2px 10px rgba(0, 119, 190, 0.5) !important;
}

body.theme-underwater .context-menu-item {
    color: #00d4ff !important;
}

body.theme-underwater .context-menu-item:hover {
    background-color: #003d6b !important;
}

body.theme-underwater .context-menu-item:active {
    background-color: #004d7a !important;
}

body.theme-underwater .context-menu-separator {
    background-color: #0077be !important;
}

body.theme-underwater .context-menu-shortcut {
    color: #4db8e8 !important;
}

body.theme-underwater .context-menu-item[data-action="showMore"]:hover,
body.theme-underwater .context-menu-item[data-action="backToEditor"]:hover {
    background-color: #0077be !important;
    color: #fff !important;
}

body.theme-underwater .context-menu-item[data-action="showMore"]:hover .context-menu-shortcut,
body.theme-underwater .context-menu-item[data-action="backToEditor"]:hover .context-menu-shortcut {
    color: #fff !important;
}

/* Sand theme context menu */
body.theme-sand #context-menu,
body.theme-sand #context-menu-extended {
    background: #fff9eb !important;
    border-color: #d4a574 !important;
    box-shadow: 0 2px 10px rgba(201, 168, 104, 0.3) !important;
}

body.theme-sand .context-menu-item {
    color: #4a3c2e !important;
}

body.theme-sand .context-menu-item:hover {
    background-color: #e8d4b0 !important;
}

body.theme-sand .context-menu-item:active {
    background-color: #d9c5a0 !important;
}

body.theme-sand .context-menu-separator {
    background-color: #d4a574 !important;
}

body.theme-sand .context-menu-shortcut {
    color: #9a7b4f !important;
}

body.theme-sand .context-menu-item[data-action="showMore"]:hover,
body.theme-sand .context-menu-item[data-action="backToEditor"]:hover {
    background-color: #c9a868 !important;
    color: #2a1f0f !important;
}

body.theme-sand .context-menu-item[data-action="showMore"]:hover .context-menu-shortcut,
body.theme-sand .context-menu-item[data-action="backToEditor"]:hover .context-menu-shortcut {
    color: #2a1f0f !important;
}

/* Night Sky theme context menu */
body.theme-night-sky #context-menu,
body.theme-night-sky #context-menu-extended {
    background: #1a1a2e !important;
    border-color: #6c5ce7 !important;
    box-shadow: 0 2px 10px rgba(108, 92, 231, 0.5) !important;
}

body.theme-night-sky .context-menu-item {
    color: #b8a3ff !important;
}

body.theme-night-sky .context-menu-item:hover {
    background-color: #16213e !important;
}

body.theme-night-sky .context-menu-item:active {
    background-color: #1f2f5a !important;
}

body.theme-night-sky .context-menu-separator {
    background-color: #6c5ce7 !important;
}

body.theme-night-sky .context-menu-shortcut {
    color: #9b8cd9 !important;
}

body.theme-night-sky .context-menu-item[data-action="showMore"]:hover,
body.theme-night-sky .context-menu-item[data-action="backToEditor"]:hover {
    background-color: #6c5ce7 !important;
    color: #fff !important;
}

body.theme-night-sky .context-menu-item[data-action="showMore"]:hover .context-menu-shortcut,
body.theme-night-sky .context-menu-item[data-action="backToEditor"]:hover .context-menu-shortcut {
    color: #fff !important;
}

/* Forest Green theme context menu */
body.theme-forest-green #context-menu,
body.theme-forest-green #context-menu-extended {
    background: #243824 !important;
    border-color: #4a7c4a !important;
    box-shadow: 0 2px 10px rgba(74, 124, 74, 0.5) !important;
}

body.theme-forest-green .context-menu-item {
    color: #90ee90 !important;
}

body.theme-forest-green .context-menu-item:hover {
    background-color: #2d5016 !important;
}

body.theme-forest-green .context-menu-item:active {
    background-color: #3a6320 !important;
}

body.theme-forest-green .context-menu-separator {
    background-color: #4a7c4a !important;
}

body.theme-forest-green .context-menu-shortcut {
    color: #76c776 !important;
}

body.theme-forest-green .context-menu-item[data-action="showMore"]:hover,
body.theme-forest-green .context-menu-item[data-action="backToEditor"]:hover {
    background-color: #4a7c4a !important;
    color: #fff !important;
}

body.theme-forest-green .context-menu-item[data-action="showMore"]:hover .context-menu-shortcut,
body.theme-forest-green .context-menu-item[data-action="backToEditor"]:hover .context-menu-shortcut {
    color: #fff !important;
}

/* Mica (Beta) styles */
body.mica-enabled {
    background: linear-gradient(135deg, #f4f7fb 0%, #e9eef6 100%);
}

/* Background Image support */
body.has-bg-image {
    background: var(--bg-image) center center / cover no-repeat fixed;
}

/* Background image + Mica effect */
body.has-bg-image.mica-enabled {
    background: var(--bg-image) center center / cover no-repeat fixed;
    position: relative;
}

/* Add a subtle overlay when both bg-image and mica are active */
body.has-bg-image.mica-enabled::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, rgba(244, 247, 251, 0.65) 0%, rgba(233, 238, 246, 0.65) 100%);
    pointer-events: none;
    z-index: 0;
}

body.has-bg-image.mica-enabled .toolbar,
body.has-bg-image.mica-enabled .main-container,
body.has-bg-image.mica-enabled .editor-pane,
body.has-bg-image.mica-enabled .preview-pane,
body.has-bg-image.mica-enabled .pane-header,
body.has-bg-image.mica-enabled .editor-textarea,
body.has-bg-image.mica-enabled .preview-content,
body.has-bg-image.mica-enabled #find-replace-bar {
    position: relative;
    z-index: 1;
}

body.mica-enabled .toolbar,
body.mica-enabled .pane-header,
body.mica-enabled .editor-pane,
body.mica-enabled .preview-pane,
body.mica-enabled .preview-content,
body.mica-enabled #find-replace-bar {
    background-color: rgba(255, 255, 255, 0.6) !important;
    -webkit-backdrop-filter: saturate(1.5) blur(12px);
    backdrop-filter: saturate(1.5) blur(12px);
}

/* Borders look softer with mica */
body.mica-enabled .toolbar,
body.mica-enabled .editor-pane,
body.mica-enabled .preview-pane,
body.mica-enabled #find-replace-bar {
    border-color: rgba(0, 0, 0, 0.12) !important;
}

/* Dark mode + Mica */
body.dark-mode.mica-enabled {
    background: linear-gradient(135deg, #0f141a 0%, #121821 100%);
}

body.dark-mode.mica-enabled .toolbar,
body.dark-mode.mica-enabled .pane-header,
body.dark-mode.mica-enabled .editor-pane,
body.dark-mode.mica-enabled .preview-pane,
body.dark-mode.mica-enabled .preview-content,
body.dark-mode.mica-enabled #find-replace-bar {
    background-color: rgba(16, 18, 20, 0.55) !important;
    -webkit-backdrop-filter: saturate(1.2) blur(14px);
    backdrop-filter: saturate(1.2) blur(14px);
    border-color: rgba(255, 255, 255, 0.12) !important;
}

/* Dark mode + Background image + Mica */
body.dark-mode.has-bg-image.mica-enabled::before {
    background: linear-gradient(135deg, rgba(15, 20, 26, 0.75) 0%, rgba(18, 24, 33, 0.75) 100%);
}

/* ========== Enhanced Syntax Highlighting ========== */

/* Code block wrapper */
.code-block-wrapper {
    position: relative;
    margin: 16px 0;
    border-radius: 8px;
    border: 1px solid rgba(0, 0, 0, 0.08);
    background: rgba(255, 255, 255, 0.95);
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
}

.code-block-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 12px;
    background: linear-gradient(to right, rgba(0, 0, 0, 0.02), rgba(0, 0, 0, 0.01));
    border-bottom: 1px solid rgba(0, 0, 0, 0.06);
    font-size: 11px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: rgba(0, 0, 0, 0.5);
}

.code-block-lang {
    display: inline-flex;
    align-items: center;
    gap: 6px;
}

.code-copy-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 28px;
    height: 28px;
    padding: 0;
    background: transparent;
    border: 1px solid rgba(0, 0, 0, 0.1);
    border-radius: 4px;
    cursor: pointer;
    color: rgba(0, 0, 0, 0.5);
    transition: all 0.2s ease;
    font-size: 14px;
}

.code-copy-btn:hover {
    background: rgba(0, 0, 0, 0.04);
    border-color: rgba(0, 0, 0, 0.2);
    color: rgba(0, 0, 0, 0.7);
}

.code-copy-btn:active {
    transform: scale(0.95);
}

.code-copy-btn .material-symbols-outlined {
    font-size: 16px;
}

.code-block-container {
    padding: 0 !important;
    margin: 0 !important;
    background: transparent !important;
    border: none !important;
    border-radius: 0 !important;
    overflow-x: auto;
    overflow-y: hidden;
}

.code-block-container code {
    display: block;
    padding: 12px 16px;
    line-height: 1.5;
    font-family: 'Fira Code', 'Consolas', 'Monaco', 'Courier New', monospace;
    font-size: 13px;
    background: transparent !important;
    color: #333;
    white-space: pre;
}

.code-highlighted {
    background: transparent !important;
}

/* Syntax highlighting token colors (light mode) */
.language-javascript .token.keyword,
.language-typescript .token.keyword,
.language-jsx .token.keyword,
.language-tsx .token.keyword,
.language-python .token.keyword,
.language-java .token.keyword,
.language-csharp .token.keyword,
.language-cpp .token.keyword,
.language-c .token.keyword {
    color: #c41a16 !important;
}

.language-javascript .token.string,
.language-typescript .token.string,
.language-jsx .token.string,
.language-tsx .token.string,
.language-python .token.string,
.language-java .token.string,
.language-csharp .token.string,
.language-cpp .token.string,
.language-c .token.string {
    color: #07893d !important;
}

.language-javascript .token.function,
.language-typescript .token.function,
.language-jsx .token.function,
.language-tsx .token.function,
.language-python .token.function,
.language-java .token.function,
.language-csharp .token.function,
.language-cpp .token.function,
.language-c .token.function {
    color: #6c3491 !important;
}

.language-javascript .token.comment,
.language-typescript .token.comment,
.language-jsx .token.comment,
.language-tsx .token.comment,
.language-python .token.comment,
.language-java .token.comment,
.language-csharp .token.comment,
.language-cpp .token.comment,
.language-c .token.comment {
    color: #7c7c7c !important;
}

.language-javascript .token.number,
.language-typescript .token.number,
.language-jsx .token.number,
.language-tsx .token.number,
.language-python .token.number,
.language-java .token.number,
.language-csharp .token.number,
.language-cpp .token.number,
.language-c .token.number {
    color: #3f6a9f !important;
}

/* Dark mode syntax highlighting */
body.dark-mode .code-block-wrapper {
    background: rgba(20, 24, 28, 0.95);
    border-color: rgba(255, 255, 255, 0.08);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
}

body.dark-mode .code-block-header {
    background: linear-gradient(to right, rgba(255, 255, 255, 0.04), rgba(255, 255, 255, 0.02));
    border-bottom-color: rgba(255, 255, 255, 0.06);
    color: rgba(255, 255, 255, 0.5);
}

body.dark-mode .code-block-container code {
    color: #e4e6eb;
}

body.dark-mode .code-copy-btn {
    border-color: rgba(255, 255, 255, 0.1);
    color: rgba(255, 255, 255, 0.5);
}

body.dark-mode .code-copy-btn:hover {
    background: rgba(255, 255, 255, 0.08);
    border-color: rgba(255, 255, 255, 0.2);
    color: rgba(255, 255, 255, 0.8);
}

/* Dark mode syntax highlighting colors */
body.dark-mode .language-javascript .token.keyword,
body.dark-mode .language-typescript .token.keyword,
body.dark-mode .language-jsx .token.keyword,
body.dark-mode .language-tsx .token.keyword,
body.dark-mode .language-python .token.keyword,
body.dark-mode .language-java .token.keyword,
body.dark-mode .language-csharp .token.keyword,
body.dark-mode .language-cpp .token.keyword,
body.dark-mode .language-c .token.keyword {
    color: #ff6f5e !important;
}

body.dark-mode .language-javascript .token.string,
body.dark-mode .language-typescript .token.string,
body.dark-mode .language-jsx .token.string,
body.dark-mode .language-tsx .token.string,
body.dark-mode .language-python .token.string,
body.dark-mode .language-java .token.string,
body.dark-mode .language-csharp .token.string,
body.dark-mode .language-cpp .token.string,
body.dark-mode .language-c .token.string {
    color: #37bb9b !important;
}

body.dark-mode .language-javascript .token.function,
body.dark-mode .language-typescript .token.function,
body.dark-mode .language-jsx .token.function,
body.dark-mode .language-tsx .token.function,
body.dark-mode .language-python .token.function,
body.dark-mode .language-java .token.function,
body.dark-mode .language-csharp .token.function,
body.dark-mode .language-cpp .token.function,
body.dark-mode .language-c .token.function {
    color: #b99fd9 !important;
}

body.dark-mode .language-javascript .token.comment,
body.dark-mode .language-typescript .token.comment,
body.dark-mode .language-jsx .token.comment,
body.dark-mode .language-tsx .token.comment,
body.dark-mode .language-python .token.comment,
body.dark-mode .language-java .token.comment,
body.dark-mode .language-csharp .token.comment,
body.dark-mode .language-cpp .token.comment,
body.dark-mode .language-c .token.comment {
    color: #8b949e !important;
}

body.dark-mode .language-javascript .token.number,
body.dark-mode .language-typescript .token.number,
body.dark-mode .language-jsx .token.number,
body.dark-mode .language-tsx .token.number,
body.dark-mode .language-python .token.number,
body.dark-mode .language-java .token.number,
body.dark-mode .language-csharp .token.number,
body.dark-mode .language-cpp .token.number,
body.dark-mode .language-c .token.number {
    color: #79c0ff !important;
}

/* Prism overrides for better appearance */
.preview-content pre {
    background: transparent !important;
    border: none !important;
    padding: 0 !important;
    margin: 0 !important;
}

.preview-content code {
    background: transparent !important;
    padding: 0 !important;
}

/* Inline code styling */
.preview-content code:not(.code-highlighted) {
    background: rgba(0, 0, 0, 0.06);
    color: #c41a16;
    padding: 2px 6px;
    border-radius: 3px;
    font-family: 'Fira Code', 'Consolas', 'Monaco', 'Courier New', monospace;
    font-size: 0.9em;
}

body.dark-mode .preview-content code:not(.code-highlighted) {
    background: rgba(255, 255, 255, 0.1);
    color: #ff6f5e;
}

/* Scrollbar styling for code blocks */
.code-block-container::-webkit-scrollbar {
    height: 6px;
}

.code-block-container::-webkit-scrollbar-track {
    background: transparent;
}

.code-block-container::-webkit-scrollbar-thumb {
    background: rgba(0, 0, 0, 0.2);
    border-radius: 3px;
}

.code-block-container::-webkit-scrollbar-thumb:hover {
    background: rgba(0, 0, 0, 0.3);
}

body.dark-mode .code-block-container::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.2);
}

body.dark-mode .code-block-container::-webkit-scrollbar-thumb:hover {
    background: rgba(255, 255, 255, 0.3);
}

